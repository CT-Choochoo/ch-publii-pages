<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>AppleScript 基础 - As One Wants</title><meta name="description" content="本章介绍本指南其余部分所涵盖的术语和规则所依据的基本概念。 文档来源 “脚本编辑器”应用程序位于 中 /Applications/Utilities 。它提供了编辑、编译和执行脚本、显示应用程序脚本术语以及以各种格式（如编译脚本、应用程序和纯文本）保存脚本的功能。 脚本编辑器可以显示执行 AppleScript 脚本的结果，并且可以显示在脚本执行期间发送的 Apple&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><meta name="theme-color" content="#17181E" media="(prefers-color-scheme: dark)"><meta name="theme-color" content="#2A2C33" media="(prefers-color-scheme: light)"><meta name="msapplication-navbutton-color" content="#2A2C33"><meta name="apple-mobile-web-app-status-bar-style" content="#2A2C33"><script async defer="defer" type="text/javascript" src="" data-website-id="74fc0332-4948-4dfe-9825-7ef3229acbce" data-auto-track="true" data-do-not-track="true" data-cache="false"></script><link rel="canonical" href="https://ct-choochoo.github.io/ch-publii-pages/applescript-ji-chu/"><link rel="alternate" type="application/atom+xml" href="https://ct-choochoo.github.io/ch-publii-pages/feed.xml"><link rel="alternate" type="application/json" href="https://ct-choochoo.github.io/ch-publii-pages/feed.json"><meta property="og:title" content="AppleScript 基础 - As One Wants "><meta property="og:image" content="https://ct-choochoo.github.io/ch-publii-pages/media/posts/37/2022-08-01-06.58.16-2894810266061428586_5823209264.jpg"><meta property="og:image:width" content="1440"><meta property="og:image:height" content="1440"><meta property="og:site_name" content="As One Wants"><meta property="og:description" content="本章介绍本指南其余部分所涵盖的术语和规则所依据的基本概念。 文档来源 “脚本编辑器”应用程序位于 中 /Applications/Utilities 。它提供了编辑、编译和执行脚本、显示应用程序脚本术语以及以各种格式（如编译脚本、应用程序和纯文本）保存脚本的功能。 脚本编辑器可以显示执行 AppleScript 脚本的结果，并且可以显示在脚本执行期间发送的 Apple&hellip;"><meta property="og:url" content="https://ct-choochoo.github.io/ch-publii-pages/applescript-ji-chu/"><meta property="og:type" content="article"><link rel="shortcut icon" href="https://ct-choochoo.github.io/ch-publii-pages/media/website/Calm.svg" type="image/x-icon"><link rel="shortcut icon" href="https://ct-choochoo.github.io/ch-publii-pages/media/website/Calm.svg" type="image/x-icon"><link rel="preload" href="https://ct-choochoo.github.io/ch-publii-pages/assets/dynamic/fonts/andadapro/andadapro.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="https://ct-choochoo.github.io/ch-publii-pages/assets/dynamic/fonts/sourcecodepro/sourcecodepro.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="https://ct-choochoo.github.io/ch-publii-pages/assets/css/style.css?v=47c3f19daec2b3d9e414a3947d12c48b"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://ct-choochoo.github.io/ch-publii-pages/applescript-ji-chu/"},"headline":"AppleScript 基础","datePublished":"2023-08-21T17:25","dateModified":"2023-08-21T17:25","image":{"@type":"ImageObject","url":"https://ct-choochoo.github.io/ch-publii-pages/media/posts/37/2022-08-01-06.58.16-2894810266061428586_5823209264.jpg","height":1440,"width":1440},"description":"本章介绍本指南其余部分所涵盖的术语和规则所依据的基本概念。 文档来源 “脚本编辑器”应用程序位于 中 /Applications/Utilities 。它提供了编辑、编译和执行脚本、显示应用程序脚本术语以及以各种格式（如编译脚本、应用程序和纯文本）保存脚本的功能。 脚本编辑器可以显示执行 AppleScript 脚本的结果，并且可以显示在脚本执行期间发送的 Apple&hellip;","author":{"@type":"Person","name":"铁柱","url":"https://ct-choochoo.github.io/ch-publii-pages/authors/tiezhu/"},"publisher":{"@type":"Organization","name":"铁柱"}}</script><script type="application/ld+json">{ "@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{ "@type": "ListItem", "position": 1, "name": "Home", "item": "https://ct-choochoo.github.io/ch-publii-pages/" },{ "@type": "ListItem", "position": 2, "name": "develop", "item": "https://ct-choochoo.github.io/ch-publii-pages/tags/kai-fa/" }] }</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript><script async defer="defer" src="https://analytics.umami.is/script.js" data-website-id="74fc0332-4948-4dfe-9825-7ef3229acbce"></script><link rel="stylesheet" href="https://ct-choochoo.github.io/ch-publii-pages/media/plugins/docSearch/docsearch.min.css"></head><body><header class="header" id="js-header"><a href="https://ct-choochoo.github.io/ch-publii-pages/" class="logo">As One Wants</a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://ct-choochoo.github.io/ch-publii-pages/" target="_self">home</a></li><li><a href="https://ct-choochoo.github.io/ch-publii-pages/tags/" target="_self">标签</a></li><li class="has-submenu"><span class="is-separator" aria-haspopup="true">工作</span><ul class="navbar__submenu level-2" aria-hidden="true"><li class="has-submenu"><span class="is-separator" aria-haspopup="true">语言</span><ul class="navbar__submenu level-3" aria-hidden="true"><li><a href="https://ct-choochoo.github.io/ch-publii-pages/tags/biao-qian/" target="_self">java</a></li><li><a href="https://ct-choochoo.github.io/ch-publii-pages/tags/python/" target="_self">python</a></li></ul></li><li class="has-submenu"><span class="is-separator" aria-haspopup="true">框架</span><ul class="navbar__submenu level-3" aria-hidden="true"><li><a href="https://ct-choochoo.github.io/ch-publii-pages/tags/springboot/" target="_self">springboot</a></li></ul></li><li><a href="https://ct-choochoo.github.io/ch-publii-pages/tags/common/" target="_self">工具</a></li></ul></li><li class="has-submenu"><a href="https://ct-choochoo.github.io/ch-publii-pages/tags/sheng-huo/" target="_self" aria-haspopup="true">生活</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://ct-choochoo.github.io/ch-publii-pages/tags/lu-you/" target="_self">游记</a></li></ul></li></ul></nav><div class="search"><div class="search__overlay js-search-overlay"><div id="docsearch"></div></div><button class="search__btn js-search-btn" aria-label="Search"><svg role="presentation" focusable="false" height="18" width="18"><use xlink:href="https://ct-choochoo.github.io/ch-publii-pages/assets/svg/svg-map.svg#search"/></svg></button></div></header><main class="main main--post"><article class="post"><header class="hero post__header"><div class="wrapper wrapper--narrow"><ol class="breadcrumb"><li><a href="https://ct-choochoo.github.io/ch-publii-pages/"><span>Home</span></a></li><li><span>&rsaquo;</span> <a href="https://ct-choochoo.github.io/ch-publii-pages/tags/kai-fa/" title="develop"><span>develop</span></a></li></ol><h1 class="post__title">AppleScript 基础</h1><div class="post__meta"><div class="post__author">By <a href="https://ct-choochoo.github.io/ch-publii-pages/authors/tiezhu/" class="invert" rel="author" title="铁柱">铁柱</a></div><time datetime="2023-08-21T17:25">23/08/21 </time><a href="https://ct-choochoo.github.io/ch-publii-pages/applescript-ji-chu/#comments" aria-label="Comments" rel="nofollow" class="post__comments"><svg><use xlink:href="https://ct-choochoo.github.io/ch-publii-pages/assets/svg/svg-map.svg#comments"/></svg></a></div></div></header><div class="wrapper main__content post__inner"><figure class="post__featured-image post__featured-image--full post__image--full"></figure><div class="post__entry"><blockquote><p class="md-end-block md-p"><span class="md-plain md-expand">本章介绍本指南其余部分所涵盖的术语和规则所依据的基本概念。</span></p><p class="md-end-block md-p"><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/conceptual/ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW2"><span class="md-plain">文档来源</span></a></span></p></blockquote><p class="md-end-block md-p"> </p><h2 class="md-end-block md-heading"><span class="md-plain">1. 脚本编辑器</span></h2><ol class="ol-list" start=""><li class="md-list-item"><p class="md-end-block md-p"><span class="md-plain">“脚本编辑器”应用程序位于 中 </span><span class="md-pair-s" spellcheck="false"><code>/Applications/Utilities</code></span><span class="md-plain"> 。它提供了编辑、编译和执行脚本、显示应用程序脚本术语以及以各种格式（如编译脚本、应用程序和纯文本）保存脚本的功能。</span></p></li><li class="md-list-item md-focus-container"><p class="md-end-block md-p md-focus"><span class="md-plain md-expand">脚本编辑器可以显示执行 AppleScript 脚本的结果，并且可以显示在脚本执行期间发送的 Apple 事件的日志。在“脚本编辑器首选项”中，您还可以选择保留最近结果或事件日志的历史记录。</span></p></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-plain">脚本编辑器对各种类型的脚本文本具有文本格式化首选项，例如语言关键字、注释等。您还可以打开或关闭脚本助手(Script Assistant)，这是一种代码补全工具，可以在您输入脚本时建议和填写脚本术语。此外，脚本编辑器提供了一个上下文菜单，可以插入许多类型的样板脚本语句，例如条件语句、注释和错误处理程序。</span></p></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-plain">字典是可脚本应用程序的一部分，用于指定它所理解的脚本术语。你可以选择File </span><span class="md-entity" style="box-sizing: border-box;" data-content="&gt;">&gt;</span><span class="md-plain">在脚本编辑器中打开字典，在计算机上显示可脚本化应用程序或脚本添加的字典。或者，您可以将应用程序图标拖动到脚本编辑器图标以显示其字典(如果它有的话)。</span></p></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-plain">要显示一个列表，其中只包含由macOS提供的可脚本应用程序和脚本添加，选择Window </span><span class="md-entity" style="box-sizing: border-box;" data-content="&gt;">&gt;</span><span class="md-plain">图书馆。双击列表中的项以显示其字典。图2-1展示了OS X v10.5中Finder应用程序的字典。这个字典被标记为" Finder.sdef "。sdef格式和其他术语格式在applecript概述中的</span><span class="md-pair-s"><em><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptX/AppleScriptX.html#//apple_ref/doc/uid/10000156i"><span class="md-plain">AppleScript Overview</span></a></span></em></span><span class="md-plain">一节中有描述。</span></p></li></ol><p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://img-boo.oss-cn-chengdu.aliyuncs.com/markdown/img/2023%2F08%2F21%2F184e562a09fdf34f7983d8ff1cadaee8.png"><img decoding="async" loading="lazy" src="https://img-boo.oss-cn-chengdu.aliyuncs.com/markdown/img/2023%2F08%2F21%2F184e562a09fdf34f7983d8ff1cadaee8.png" alt="image-20230820171806291" data-is-external-image="true"></span></p><p class="md-end-block md-p"> </p><h2 class="md-end-block md-heading"><span class="md-plain">2. AppleScript and Objects - AppleScript 和对象</span></h2><p class="md-end-block md-p"><span class="md-plain">AppleScript 是一种面向对象的语言。在编写、编译和执行脚本时，你所处理的一切都是对象。对象是类定义的实例化，可以包含属性和操作。AppleScript 为你最常使用的对象定义了类，首先是顶级 </span><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-SW5"><span class="md-plain">script</span></a></span><span class="md-plain"> 对象，也就是你正在使用的整个脚本。</span></p><p class="md-end-block md-p"><span class="md-plain">在 </span><span class="md-pair-s" spellcheck="false"><code>script</code></span><span class="md-plain"> 对象内，您可以与其他对象一起工作，包括</span></p><ul class="ul-list" data-mark="-"><li class="md-list-item"><p class="md-end-block md-p"><span class="md-plain">AppleScript 为布尔值、脚本、文本、数字和其他用于脚本的对象定义了类；有关完整列表，请参阅</span><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-246384"><span class="md-plain">Class Reference</span></a></span><span class="md-plain">。</span></p></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-plain">macOS 的可编写脚本部分和随附的应用程序，如 Finder、System Events 和 Database Events（位于 </span><span class="md-pair-s" spellcheck="false"><code>/System/Library/CoreServices</code></span><span class="md-plain"> ），定义了许多有用的类。</span></p></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-plain">第三方脚本应用程序定义了支持各种功能的类。</span></p></li></ul><h3 class="md-end-block md-heading"><span class="md-plain">2.1 What Is in a Script Object - 脚本类包含哪些内容</span></h3><p class="md-end-block md-p"><span class="md-plain">在脚本编辑器的脚本窗口中输入 AppleScript 语句时，您是在顶级 </span><span class="md-pair-s" spellcheck="false"><code>script</code></span><span class="md-plain"> 对象中工作。所有 </span><span class="md-pair-s" spellcheck="false"><code>script</code></span><span class="md-plain"> 对象定义都遵循相同的语法，只是顶级 </span><span class="md-pair-s" spellcheck="false"><code>script</code></span><span class="md-plain"> 对象没有标记开始和结束的语句。</span></p><p class="md-end-block md-p"><span class="md-plain">script 包含以下内容：</span></p><ul class="ul-list" data-mark="-"><li class="md-list-item"><p class="md-end-block md-p"><span class="md-plain">属性定义 （可选） 变量</span></p></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-plain">明确 run 处理程序（可选） </span><span class="md-pair-s" spellcheck="false"><code>run</code></span><span class="md-plain"> 处理程序包含运行脚本时 AppleScript 执行的语句。(更多信息，请参阅 </span><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/conceptual/ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW15"><span class="md-plain">run Handlers</span></a></span><span class="md-plain">）</span></p></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-plain">隐式 run 处理程序（可选） 隐式 </span><span class="md-pair-s" spellcheck="false"><code>run</code></span><span class="md-plain"> 处理程序包括在任何包含的处理程序或 </span><span class="md-pair-s" spellcheck="false"><code>script</code></span><span class="md-plain"> 对象之外的任何语句。</span></p></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-plain">附加处理程序（可选）：处理程序相当于子程序。(详情请参阅 </span><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/conceptual/ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-CJBIDBJH"><span class="md-plain">About Handlers</span></a></span><span class="md-plain">）。</span></p></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-plain">附加 </span><span class="md-pair-s" spellcheck="false"><code>script</code></span><span class="md-plain"> 对象（可选）：</span><span class="md-pair-s" spellcheck="false"><code>script</code></span><span class="md-plain"> 对象可以包含嵌套的 </span><span class="md-pair-s" spellcheck="false"><code>script</code></span><span class="md-plain"> 对象，每个嵌套对象的定义都与顶层的 </span><span class="md-pair-s" spellcheck="false"><code>script</code></span><span class="md-plain"> 对象相同，只是嵌套的 </span><span class="md-pair-s" spellcheck="false"><code>script</code></span><span class="md-plain"> 对象在括号中用语句标明其开始和结束。(详情请参阅脚本对象）。</span></p></li></ul><p class="md-end-block md-p"><span class="md-plain">下面是一个简单脚本的示例，其中包含一个属性、一个处理程序、一个嵌套的 </span><span class="md-pair-s" spellcheck="false"><code>script</code></span><span class="md-plain"> 对象和一个隐式 </span><span class="md-pair-s" spellcheck="false"><code>run</code></span><span class="md-plain"> 处理程序，处理程序包含两条语句：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="apl" spellcheck="false"> <span role="presentation"><span class="cm-keyword">property</span> <span class="cm-keyword">defaultClientName</span> <span class="cm-keyword">:</span> <span class="cm-string">"Mary Smith"</span></span><br>  <br> <span role="presentation"><span class="cm-keyword">on</span> <span class="cm-keyword">greetClient</span>(<span class="cm-keyword">nameOfClient</span>)</span><br> <span role="presentation">    <span class="cm-keyword">display</span> <span class="cm-keyword">dialog</span> (<span class="cm-string">"Hello "</span> <span class="cm-keyword">&amp;</span> <span class="cm-keyword">nameOfClient</span> <span class="cm-keyword">&amp;</span> <span class="cm-string">"!"</span>)</span><br> <span role="presentation"><span class="cm-keyword">end</span> <span class="cm-keyword">greetClient</span></span><br>  <br> <span role="presentation"><span class="cm-keyword">script</span> <span class="cm-keyword">testGreet</span></span><br> <span role="presentation">    <span class="cm-keyword">greetClient</span>(<span class="cm-keyword">defaultClientName</span>)</span><br> <span role="presentation"><span class="cm-keyword">end</span> <span class="cm-keyword">script</span></span><br>  <br> <span role="presentation"><span class="cm-keyword">run</span> <span class="cm-keyword">testGreet</span> <span class="cm-keyword">--result:</span> <span class="cm-string">"Hello Mary Smith!"</span></span><br> <span role="presentation"><span class="cm-keyword">greetClient</span>(<span class="cm-string">"Joe Jones"</span>) <span class="cm-keyword">--result:</span> <span class="cm-string">"Hello Joe Jones!"</span></span></pre><p class="md-end-block md-p"><span class="md-pair-s" spellcheck="false"><code>run</code></span><span class="md-plain"> 处理程序的第一条语句是 </span><span class="md-pair-s" spellcheck="false"><code>run testGreet</code></span><span class="md-plain"> ，运行嵌套的 </span><span class="md-pair-s" spellcheck="false"><code>script</code></span><span class="md-plain"> 对象 </span><span class="md-pair-s" spellcheck="false"><code>testGreet</code></span><span class="md-plain"> 。 </span><span class="md-pair-s" spellcheck="false"><code>script</code></span><span class="md-plain"> 对象调用处理程序 </span><span class="md-pair-s" spellcheck="false"><code>greetClient()</code></span><span class="md-plain"> ，传递属性 </span><span class="md-pair-s" spellcheck="false"><code>defaultClientName</code></span><span class="md-plain"> 。处理程序会显示一个对话框，问候默认客户端Mary Smith。</span></p><p class="md-end-block md-p"><span class="md-pair-s" spellcheck="false"><code>run</code></span><span class="md-plain"> 处理程序中的第二条语句直接调用 </span><span class="md-pair-s" spellcheck="false"><code>greetClient()</code></span><span class="md-plain"> ，传递字符串 </span><span class="md-pair-s" spellcheck="false"><code>"Joe Jones"</code></span><span class="md-plain"> 。</span></p><blockquote><p class="md-end-block md-p"><span class="md-plain">从Java语言的角度来看，AppleScript的脚本对象可以与Java中的类进行比较。以下是AppleScript脚本对象的各个部分与Java的对应关系：</span></p><ol class="ol-list" start=""><li class="md-list-item"><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">Property definitions (optional)</span></strong></span><span class="md-plain">:</span></p><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">Java</span></strong></span><span class="md-plain">: 这与Java中的类变量或属性相似。它们是用来存储数据的容器。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="java" spellcheck="false"> <span role="presentation"><span class="cm-keyword">public</span> <span class="cm-keyword">class</span> <span class="cm-def">MyClass</span> {</span><br> <span role="presentation">    <span class="cm-keyword">private</span> <span class="cm-variable-3">int</span> <span class="cm-variable">myProperty</span>;</span><br> <span role="presentation">}</span></pre></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">An explicit run handler (optional)</span></strong></span><span class="md-plain">:</span></p><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">Java</span></strong></span><span class="md-plain">: 这可以看作是Java类中的一个特定方法，当该类被执行时会调用这个方法。在Java中，这类似于</span><span class="md-pair-s" spellcheck="false"><code>main</code></span><span class="md-plain">方法。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="java" spellcheck="false"> <span role="presentation"><span class="cm-keyword">public</span> <span class="cm-keyword">static</span> <span class="cm-variable-3">void</span> <span class="cm-def">main</span>(<span class="cm-variable-3">String</span>[] <span class="cm-variable">args</span>) {</span><br> <span role="presentation">    <span class="cm-comment">// code to be executed</span></span><br> <span role="presentation">}</span></pre></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">An implicit run handler (optional)</span></strong></span><span class="md-plain">:</span></p><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">Java</span></strong></span><span class="md-plain">: 这是类中不在任何方法内的代码块。但在Java中，所有的代码都需要放在方法内，所以没有直接的对应。但可以将其看作是静态代码块或初始化块。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="java" spellcheck="false"> <span role="presentation"><span class="cm-keyword">static</span> {</span><br> <span role="presentation">    <span class="cm-comment">// static initialization code</span></span><br> <span role="presentation">}</span></pre></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">Additional handlers (optional)</span></strong></span><span class="md-plain">:</span></p><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">Java</span></strong></span><span class="md-plain">: 这与Java中的方法相似。它们是执行特定功能的代码块。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="java" spellcheck="false"> <span role="presentation"><span class="cm-keyword">public</span> <span class="cm-variable-3">void</span> <span class="cm-def">myMethod</span>() {</span><br> <span role="presentation">    <span class="cm-comment">// code for the method</span></span><br> <span role="presentation">}</span></pre></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">Additional script objects (optional)</span></strong></span><span class="md-plain">:</span></p><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">Java</span></strong></span><span class="md-plain">: 这与Java中的内部类或嵌套类相似。一个类可以包含其他类。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="java" spellcheck="false"> <span role="presentation"><span class="cm-keyword">public</span> <span class="cm-keyword">class</span> <span class="cm-def">OuterClass</span> {</span><br> <span role="presentation">    <span class="cm-keyword">public</span> <span class="cm-keyword">class</span> <span class="cm-def">InnerClass</span> {</span><br> <span role="presentation">        <span class="cm-comment">// inner class code</span></span><br> <span role="presentation">    }</span><br> <span role="presentation">}</span></pre></li></ol><p class="md-end-block md-p"><span class="md-plain">总的来说，AppleScript的脚本对象与Java的类有很多相似之处，都包含属性、方法和可能的嵌套结构。但AppleScript的运行处理器（run handler）是其独特的特点，而Java则通过特定的方法（如</span><span class="md-pair-s" spellcheck="false"><code>main</code></span><span class="md-plain">方法）来执行代码。</span></p></blockquote><h3 class="md-end-block md-heading"><span class="md-plain">2.2 Properties - 属性</span></h3><p class="md-end-block md-p"><span class="md-plain">对象的属性是具有单一值和标签的特性，如窗口的 </span><span class="md-pair-s" spellcheck="false"><code>name</code></span><span class="md-plain"> 属性或日期的 </span><span class="md-pair-s" spellcheck="false"><code>month</code></span><span class="md-plain"> 属性。任何 AppleScript 类的定义都包括其每个属性的名称和类。在一个类中，属性名称必须是唯一的。属性值可以是读/写或只读。</span></p><p class="md-end-block md-p"><span class="md-plain">例如，AppleScript </span><span class="md-pair-s" spellcheck="false"><code>date</code></span><span class="md-plain"> 类定义了读/写和只读属性。这些属性包括 </span><span class="md-pair-s" spellcheck="false"><code>weekday</code></span><span class="md-plain"> 属性（只读）和 </span><span class="md-pair-s" spellcheck="false"><code>month</code></span><span class="md-plain"> 、 </span><span class="md-pair-s" spellcheck="false"><code>day</code></span><span class="md-plain"> 和 </span><span class="md-pair-s" spellcheck="false"><code>year</code></span><span class="md-plain"> 属性（读/写）。这是因为 </span><span class="md-pair-s" spellcheck="false"><code>weekday</code></span><span class="md-plain"> 属性的值取决于其他属性--你不能将任意工作日设置为实际日期。</span></p><p class="md-end-block md-p"><span class="md-plain">属性的类可以是简单类（如 </span><span class="md-pair-s" spellcheck="false"><code>boolean</code></span><span class="md-plain"> 或 </span><span class="md-pair-s" spellcheck="false"><code>integer</code></span><span class="md-plain"> ）、复合类（如 </span><span class="md-pair-s" spellcheck="false"><code>point</code></span><span class="md-plain"> 类（由两个整数组成））或更复杂的类。</span></p><p class="md-end-block md-p"><span class="md-plain">大多数类只支持预定义属性。不过，对于 </span><span class="md-pair-s" spellcheck="false"><code>script</code></span><span class="md-plain"> 类，AppleScript 允许你定义其他属性。有关如何定义的信息，请参阅</span><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/conceptual/ASLR_variables.html#//apple_ref/doc/uid/TP40000983-CH223-SW2"><span class="md-plain">Defining Properties</span></a></span><span class="md-plain">。您还可以为 </span><span class="md-pair-s" spellcheck="false"><code>record</code></span><span class="md-plain"> 对象定义属性。</span></p><p class="md-end-block md-p"> </p><h3 class="md-end-block md-heading"><span class="md-plain">2.3 Elements - 元素</span></h3><p class="md-end-block md-p"><span class="md-plain">元素是包含在另一个对象中的对象。任何 AppleScript 类的定义都包括其可包含的元素类型。一个对象通常可以包含零个或多个元素。</span></p><p class="md-end-block md-p"><span class="md-plain">对于给定的元素类型，一个对象可以包含很多元素，也可以不包含任何元素，而且它所包含的元素数量可能会随着时间的推移而改变。例如，一个 </span><span class="md-pair-s" spellcheck="false"><code>list</code></span><span class="md-plain"> 对象可能不包含任何项目（可以是一个空列表）。之后，同一个列表可能包含许多项目。</span></p><p class="md-end-block md-p"><span class="md-plain">能否在对象中添加元素或从对象中删除元素取决于类和元素。例如， </span><span class="md-pair-s" spellcheck="false"><code>text</code></span><span class="md-plain"> 对象是不可变的--对象创建后就不能添加或删除文本。对于 </span><span class="md-pair-s" spellcheck="false"><code>list</code></span><span class="md-plain"> 对象，您不能删除项目，但可以使用 </span><span class="md-pair-s" spellcheck="false"><code>set</code></span><span class="md-plain"> 命令在开头或结尾添加项目：</span></p><figure class="md-table-fig table-figure"><table class="md-table"><thead><tr class="md-end-block"><th><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>set myList to {1, "what", 3} --result: {1, "what", 3}</code></span></span></th></tr></thead><tbody><tr class="md-end-block"><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>set beginning of myList to 0</code></span></span></td></tr><tr class="md-end-block"><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>set end of myList to "four"</code></span></span></td></tr><tr class="md-end-block"><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>myList --result: {0, 1, "what", 3, "four"}</code></span></span></td></tr></tbody></table></figure><blockquote><p class="md-end-block md-p"><span class="md-plain">从Java的角度来看，AppleScript中的元素（element）概念与Java中的集合或数组中的元素有些相似。以下是AppleScript中的元素与Java的对应关系：</span></p><ol class="ol-list" start=""><li class="md-list-item"><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">Element</span></strong></span><span class="md-plain">:</span></p><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">Java</span></strong></span><span class="md-plain">: 在Java中，集合（如</span><span class="md-pair-s" spellcheck="false"><code>ArrayList</code></span><span class="md-plain">、</span><span class="md-pair-s" spellcheck="false"><code>HashSet</code></span><span class="md-plain">等）或数组中的项可以被视为元素。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="java" spellcheck="false"> <span role="presentation"><span class="cm-variable">ArrayList</span><span class="cm-operator">&lt;</span><span class="cm-variable-3">String</span><span class="cm-operator">&gt;</span> <span class="cm-variable">myList</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">ArrayList</span><span class="cm-operator">&lt;&gt;</span>();</span><br> <span role="presentation"><span class="cm-variable">myList</span>.<span class="cm-variable">add</span>(<span class="cm-string">"item1"</span>);</span><br> <span role="presentation"><span class="cm-variable">myList</span>.<span class="cm-variable">add</span>(<span class="cm-string">"item2"</span>);</span></pre></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">Definition for any AppleScript class includes the element types it can contain</span></strong></span><span class="md-plain">:</span></p><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">Java</span></strong></span><span class="md-plain">: 在Java中，泛型可以限制集合中可以包含的元素类型。例如，</span><span class="md-pair-s" spellcheck="false"><code>ArrayList&lt;String&gt;</code></span><span class="md-plain">只能包含字符串。</span></p></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">An object can typically contain zero or more of each of its elements</span></strong></span><span class="md-plain">:</span></p><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">Java</span></strong></span><span class="md-plain">: 一个Java集合可以为空，或者可以包含多个元素。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="java" spellcheck="false"> <span role="presentation"><span class="cm-variable">ArrayList</span><span class="cm-operator">&lt;</span><span class="cm-variable-3">String</span><span class="cm-operator">&gt;</span> <span class="cm-variable">emptyList</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">ArrayList</span><span class="cm-operator">&lt;&gt;</span>();</span></pre></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">For a given element type, an object can contain many elements or none</span></strong></span><span class="md-plain">:</span></p><ul class="ul-list" data-mark="-"><li class="md-list-item"><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">Java</span></strong></span><span class="md-plain">: 这与Java集合的行为相似。例如，一个</span><span class="md-pair-s" spellcheck="false"><code>ArrayList</code></span><span class="md-plain">可以为空，或者可以包含多个元素。</span></p></li></ul></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">Whether you can add elements to or remove elements from an object depends on the class and the element</span></strong></span><span class="md-plain">:</span></p><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">Java</span></strong></span><span class="md-plain">: 在Java中，某些集合类型是不可变的，例如</span><span class="md-pair-s" spellcheck="false"><code>Arrays.asList()</code></span><span class="md-plain">返回的列表。但大多数集合，如</span><span class="md-pair-s" spellcheck="false"><code>ArrayList</code></span><span class="md-plain">，允许添加和删除元素。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="java" spellcheck="false"> <span role="presentation"><span class="cm-variable">ArrayList</span><span class="cm-operator">&lt;</span><span class="cm-variable-3">String</span><span class="cm-operator">&gt;</span> <span class="cm-variable">myList</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">ArrayList</span><span class="cm-operator">&lt;&gt;</span>();</span><br> <span role="presentation"><span class="cm-variable">myList</span>.<span class="cm-variable">add</span>(<span class="cm-string">"item1"</span>);  <span class="cm-comment">// 添加元素</span></span><br> <span role="presentation"><span class="cm-variable">myList</span>.<span class="cm-variable">remove</span>(<span class="cm-string">"item1"</span>);  <span class="cm-comment">// 删除元素</span></span></pre></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">For a list object, you cannot remove items, but you can use the set command to add an item to the beginning or end</span></strong></span><span class="md-plain">:</span></p><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">Java</span></strong></span><span class="md-plain">: 在Java的</span><span class="md-pair-s" spellcheck="false"><code>ArrayList</code></span><span class="md-plain">中，你可以使用</span><span class="md-pair-s" spellcheck="false"><code>add(int index, E element)</code></span><span class="md-plain">方法在指定位置添加元素，或使用</span><span class="md-pair-s" spellcheck="false"><code>remove(int index)</code></span><span class="md-plain">方法删除指定位置的元素。</span></p><pre class="md-fences mock-cm md-end-block md-fences-with-lineno" lang="java" spellcheck="false">ArrayList&lt;String&gt; myList = new ArrayList&lt;&gt;();<br>myList.add(0, "itemAtBeginning");  // 在开始位置添加元素<br>myList.add(myList.size(), "itemAtEnd");  // 在末尾添加元素</pre></li></ol></blockquote><h3 class="md-end-block md-heading"><span class="md-plain">2.4 Object Specifiers - 对象标志符</span></h3><p class="md-end-block md-p"><span class="md-plain">对象指定符指定了查找另一个对象所需的信息，即该对象所包含的对象。对象指定符可以指应用程序对象（如窗口或文件），也可以指 AppleScript 对象（如列表中的项目或记录中的属性）。</span></p><p class="md-end-block md-p"><span class="md-plain">只有在运行脚本时，而不是在编译脚本时，对象指定符才会被完全评估（或解析）。脚本可以包含一个有效的对象指定符（如 </span><span class="md-pair-s" spellcheck="false"><code>third document of application "TextEdit"</code></span><span class="md-plain"> ），但在执行脚本时会导致错误（例如，因为打开的文档可能少于三个）。</span></p><p class="md-end-block md-p"><span class="md-plain">应用程序在响应命令时通常会返回对象指定符。例如，如果你要求 Finder 提供一个窗口，它会返回指定脚本所要求的窗口对象（如果存在）的信息。对象指定符中的顶层容器通常是应用程序本身。</span></p><p class="md-end-block md-p"><span class="md-plain">每次脚本使用描述对象或属性路径的短语时，都会创建一个对象指定符，例如 </span><span class="md-pair-s" spellcheck="false"><code>name of window 1 of application "Finder"</code></span><span class="md-plain"> 。当您使用 </span><span class="md-pair-s" spellcheck="false"><code>a reference to</code></span><span class="md-plain"> 操作符时，它会创建一个包裹对象指定符的 </span><span class="md-pair-s" spellcheck="false"><code>reference</code></span><span class="md-plain"> 对象。</span></p><p class="md-end-block md-p"><span class="md-plain">对象指定符与其所指对象之间的区别，就像建筑物地址与建筑物本身之间的区别一样。地址是一系列单词和数字，例如 "2121 Oak Street, San Francisco, CA"，它标识了一个地点（在一条街道上、一个城市里、一个州里）。它有别于建筑物本身。如果该地点的建筑被拆除，取而代之的是一栋新建筑，地址也不会改变。</span></p><p class="md-end-block md-p"> </p><blockquote><p class="md-end-block md-p"><span class="md-plain">从Java的角度来看，AppleScript中的对象说明符（object specifier）与Java中的引用有些相似。以下是AppleScript中的对象说明符与Java的对应关系：</span></p><ol class="ol-list" start=""><li class="md-list-item"><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">Object Specifier</span></strong></span><span class="md-plain">:</span></p><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">Java</span></strong></span><span class="md-plain">: 在Java中，当你创建一个对象并将其赋值给一个变量时，这个变量实际上存储的是对象的引用，而不是对象本身。这个引用可以被视为一个指向对象的“指针”或“地址”。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="java" spellcheck="false"> <span role="presentation"><span class="cm-variable">Window</span> <span class="cm-variable">mainWindow</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">Window</span>(<span class="cm-string">"Main Window"</span>);</span></pre><p class="md-end-block md-p"><span class="md-plain">在上面的例子中，</span><span class="md-pair-s" spellcheck="false"><code>mainWindow</code></span><span class="md-plain">是一个指向</span><span class="md-pair-s" spellcheck="false"><code>Window</code></span><span class="md-plain">对象的引用。</span></p></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">An object specifier is fully evaluated (or resolved) only when a script is run, not when it is compiled</span></strong></span><span class="md-plain">:</span></p><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">Java</span></strong></span><span class="md-plain">: 在Java中，对象的实例化（即</span><span class="md-pair-s" spellcheck="false"><code>new</code></span><span class="md-plain">操作）发生在运行时。但类型检查和编译时错误检查是在编译时完成的。</span></p></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">Applications typically return object specifiers in response to commands</span></strong></span><span class="md-plain">:</span></p><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">Java</span></strong></span><span class="md-plain">: 当你调用一个方法并且它返回一个对象，实际上返回的是该对象的引用。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="java" spellcheck="false"> <span role="presentation"><span class="cm-keyword">public</span> <span class="cm-variable">Window</span> <span class="cm-def">getWindow</span>() {</span><br> <span role="presentation">    <span class="cm-keyword">return</span> <span class="cm-keyword">new</span> <span class="cm-variable">Window</span>(<span class="cm-string">"Returned Window"</span>);</span><br> <span role="presentation">}</span></pre></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">The top-level container in an object specifier is typically the application itself</span></strong></span><span class="md-plain">:</span></p><ul class="ul-list" data-mark="-"><li class="md-list-item"><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">Java</span></strong></span><span class="md-plain">: 在Java中，顶级容器可以是主类或主应用程序，它包含和管理其他对象。</span></p></li></ul></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">You create an object specifier every time your script uses a phrase that describes the path to an object or property</span></strong></span><span class="md-plain">:</span></p><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">Java</span></strong></span><span class="md-plain">: 在Java中，你可以通过对象引用来访问其属性或方法。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="java" spellcheck="false"> <span role="presentation"><span class="cm-variable-3">String</span> <span class="cm-variable">title</span> <span class="cm-operator">=</span> <span class="cm-variable">mainWindow</span>.<span class="cm-variable">getTitle</span>();</span></pre></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">The difference between an object specifier and the object it refers to</span></strong></span><span class="md-plain">:</span></p><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">Java</span></strong></span><span class="md-plain">: 这与Java中的引用与实际对象之间的区别相似。引用是一个指向对象的指针，而实际的对象存在于内存的某个位置。你可以有多个引用指向同一个对象，但对象本身只有一个。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="java" spellcheck="false"> <span role="presentation"><span class="cm-variable">Window</span> <span class="cm-variable">anotherReference</span> <span class="cm-operator">=</span> <span class="cm-variable">mainWindow</span>;</span></pre><p class="md-end-block md-p"><span class="md-plain">在上面的例子中，</span><span class="md-pair-s" spellcheck="false"><code>mainWindow</code></span><span class="md-plain">和</span><span class="md-pair-s" spellcheck="false"><code>anotherReference</code></span><span class="md-plain">都指向同一个</span><span class="md-pair-s" spellcheck="false"><code>Window</code></span><span class="md-plain">对象。</span></p></li></ol></blockquote><h4 class="md-end-block md-heading"><span class="md-plain">2.4.1 What Is in an Object Specifier 对象说明符包含哪些内容</span></h4><p class="md-end-block md-p"><span class="md-plain">对象指定符描述了一个对象的类型、位置以及如何将该对象与该位置上相同类型的其他对象区分开来。这三种类型的信息--类型（或类）、位置（或容器）和区别信息（或引用形式）--允许你指定任何对象。</span></p><p class="md-end-block md-p"><span class="md-plain">在下面的示例中，对象的类是 </span><span class="md-pair-s" spellcheck="false"><code>paragraph</code></span><span class="md-plain"> 。容器是短语 </span><span class="md-pair-s" spellcheck="false"><code>of document 1</code></span><span class="md-plain"> 。由于该短语位于 </span><span class="md-pair-s" spellcheck="false"><code>tell</code></span><span class="md-plain"> 语句中，因此 </span><span class="md-pair-s" spellcheck="false"><code>tell</code></span><span class="md-plain"> 语句提供了顶层容器 </span><span class="md-pair-s" spellcheck="false"><code>of application "TextEdit"</code></span><span class="md-plain"> 。区别信息（引用形式）是类 </span><span class="md-pair-s" spellcheck="false"><code>paragraph</code></span><span class="md-plain"> 和索引值 </span><span class="md-pair-s" spellcheck="false"><code>1</code></span><span class="md-plain"> 的组合，它们共同表示第一段。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="apl" spellcheck="false"> <span role="presentation"><span class="cm-keyword">tell</span> <span class="cm-keyword">application</span> <span class="cm-string">"TextEdit"</span></span><br> <span role="presentation">    <span class="cm-keyword">paragraph</span> <span class="cm-number">1</span> <span class="cm-keyword">of</span> <span class="cm-keyword">document</span> <span class="cm-number">1</span></span><br> <span role="presentation"><span class="cm-keyword">end</span> <span class="cm-keyword">tell</span></span></pre><p class="md-end-block md-p"><span class="md-plain">注：如果查看 TextEdit 应用程序的字典，您可能会认为该脚本应该写 </span><span class="md-pair-s" spellcheck="false"><code>paragraph 1 of text of document 1</code></span><span class="md-plain"> 。不过，如果意思不明确，有些应用程序允许脚本编写者从对象指定符中省略容器，从而使脚本编写者的工作更加轻松。TextEdit 就使用了这一功能，为文档中的文本提供了一个隐式指定的子容器。也就是说，如果一个对象指定符标识了一个包含在文档文本中的对象（如单词或段落），TextEdit 就会自动提供该对象指定符的 </span><span class="md-pair-s" spellcheck="false"><code>of text</code></span><span class="md-plain"> 部分。</span></p><p class="md-end-block md-p"><span class="md-plain">除了索引引用表单外，您还可以通过名称、范围、ID 和</span><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/reference/ASLR_reference_forms.html#//apple_ref/doc/uid/TP40000983-CH4g-120522"><span class="md-plain">Reference Forms</span></a></span><span class="md-plain">中描述的其他表单来指定容器中的对象。</span></p><p class="md-end-block md-p"> </p><h4 class="md-end-block md-heading"><span class="md-plain">2.4.2 Containers 容器</span></h4><p class="md-end-block md-p"><span class="md-plain">容器是包含一个或多个对象或属性的对象。在对象说明符中，容器指定了查找对象或属性的位置。要指定容器，请使用 </span><span class="md-pair-s" spellcheck="false"><code>of</code></span><span class="md-plain"> 或 </span><span class="md-pair-s" spellcheck="false"><code>in</code></span><span class="md-plain"> ，如下面的语句（来自 Finder </span><span class="md-pair-s" spellcheck="false"><code>tell</code></span><span class="md-plain"> 块）：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false"> <span role="presentation">folder "Applications" of startup disk</span></pre><p class="md-end-block md-p"><span class="md-plain">容器可以是一个对象，也可以是一系列对象，从最内层到最外层依次排列，如下图所示：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="apl" spellcheck="false"> <span role="presentation"><span class="cm-keyword">tell</span> <span class="cm-keyword">application</span> <span class="cm-string">"Finder"</span></span><br> <span role="presentation">    <span class="cm-keyword">first</span> <span class="cm-keyword">item</span> <span class="cm-keyword">of</span> <span class="cm-keyword">first</span> <span class="cm-keyword">folder</span> <span class="cm-keyword">of</span> <span class="cm-keyword">first</span> <span class="cm-keyword">disk</span></span><br> <span role="presentation"><span class="cm-keyword">end</span> <span class="cm-keyword">tell</span></span></pre><p class="md-end-block md-p"><span class="md-plain">也可以使用属格形式 ( </span><span class="md-pair-s" spellcheck="false"><code>'s</code></span><span class="md-plain"> ) 来指定容器。在下面的示例中，最内层的容器是 </span><span class="md-pair-s" spellcheck="false"><code>first window</code></span><span class="md-plain"> ，其中包含的对象是 </span><span class="md-pair-s" spellcheck="false"><code>name</code></span><span class="md-plain"> 属性：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="apl" spellcheck="false"> <span role="presentation"><span class="cm-keyword">tell</span> <span class="cm-keyword">application</span> <span class="cm-string">"TextEdit"</span></span><br> <span role="presentation">    <span class="cm-keyword">first</span> <span class="cm-keyword">window</span><span class="cm-string">'s name</span></span><br> <span role="presentation"><span class="cm-keyword">end</span> <span class="cm-keyword">tell</span></span></pre><p class="md-end-block md-p"><span class="md-plain">在本例中， </span><span class="md-pair-s" spellcheck="false"><code>tell</code></span><span class="md-plain"> 语句 ( </span><span class="md-pair-s" spellcheck="false"><code>"TextEdit"</code></span><span class="md-plain"> ) 的目标是对象指定符的外部容器。</span></p><p class="md-end-block md-p"> </p><h4 class="md-end-block md-heading"><span class="md-plain">2.4.3 Absolute and Relative Object Specifiers 绝对和相对对象指定符</span></h4><p class="md-end-block md-p"><span class="md-plain">绝对对象指定符有足够的信息来唯一地识别一个或多个对象。它可以在脚本的任何地方明确使用。要使对应用程序对象的引用具有绝对性，其最外层的容器必须是应用程序本身，如下所示：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="apl" spellcheck="false"> <span role="presentation"><span class="cm-keyword">version</span> <span class="cm-keyword">of</span> <span class="cm-keyword">application</span> <span class="cm-string">"Finder"</span> <span class="cm-keyword">--result:</span> <span class="cm-string">"10.5.1"</span></span></pre><p class="md-end-block md-p"><span class="md-plain">与此相反，相对对象指定符没有指定足够的信息来唯一地识别一个或多个对象，例如</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="apl" spellcheck="false"> <span role="presentation"><span class="cm-keyword">name</span> <span class="cm-keyword">of</span> <span class="cm-keyword">item</span> <span class="cm-number">1</span> <span class="cm-keyword">of</span> <span class="cm-keyword">disk</span> <span class="cm-number">2</span></span></pre><p class="md-end-block md-p"><span class="md-plain">当 AppleScript 在 </span><span class="md-pair-s" spellcheck="false"><code>tell</code></span><span class="md-plain"> 语句中遇到相对对象指定符时，它会尝试使用语句指定的默认目标来完成对象指定符。虽然一般情况下并不需要，但可以使用关键字 </span><span class="md-pair-s" spellcheck="false"><code>it</code></span><span class="md-plain"> 来显式地指定这个隐式目标，详情请参阅 it 和 me 关键字。</span></p><p class="md-end-block md-p"><span class="md-plain">如果没有指定其他对象， </span><span class="md-pair-s" spellcheck="false"><code>tell</code></span><span class="md-plain"> 语句的默认目标是接收命令的对象。例如，下面的 </span><span class="md-pair-s" spellcheck="false"><code>tell</code></span><span class="md-plain"> 语句告诉 Finder 使用前面的相对对象指定符获取一个名称。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="apl" spellcheck="false"> <span role="presentation"><span class="cm-keyword">tell</span> <span class="cm-keyword">application</span> <span class="cm-string">"Finder"</span></span><br> <span role="presentation">    <span class="cm-keyword">name</span> <span class="cm-keyword">of</span> <span class="cm-keyword">item</span> <span class="cm-number">1</span> <span class="cm-keyword">of</span> <span class="cm-keyword">disk</span> <span class="cm-number">2</span></span><br> <span role="presentation"><span class="cm-keyword">end</span> <span class="cm-keyword">tell</span></span></pre><p class="md-end-block md-p"><span class="md-plain">当 AppleScript 在任何 </span><span class="md-pair-s" spellcheck="false"><code>tell</code></span><span class="md-plain"> 语句之外遇到相对对象指定符时，它会尝试通过查找</span><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/conceptual/ASLR_script_objects.html#//apple_ref/doc/uid/TP40000983-CH207-SW5"><span class="md-plain">Inheritance in Script Objects</span></a></span><span class="md-plain">描述的继承链来完成对象指定符。</span></p><p class="md-end-block md-p"> </p><h4 class="md-end-block md-heading"><span class="md-plain">2.4.4 Object Specifiers in Reference Object - 引用对象中的对象指定符</span></h4><p class="md-end-block md-p"><span class="md-plain">使用 </span><span class="md-pair-s" spellcheck="false"><code>a reference to</code></span><span class="md-plain"> 运算符创建 </span><span class="md-pair-s" spellcheck="false"><code>reference</code></span><span class="md-plain"> 对象时，其中包含一个对象指定符。例如</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="apl" spellcheck="false"> <span role="presentation"><span class="cm-keyword">tell</span> <span class="cm-keyword">application</span> <span class="cm-string">"TextEdit"</span></span><br> <span role="presentation">    <span class="cm-keyword">set</span> <span class="cm-keyword">docRef</span> <span class="cm-keyword">to</span> <span class="cm-keyword">a</span> <span class="cm-keyword">reference</span> <span class="cm-keyword">to</span> <span class="cm-keyword">the</span> <span class="cm-keyword">first</span> <span class="cm-keyword">document</span></span><br> <span role="presentation">    <span class="cm-keyword">--result:</span> <span class="cm-keyword">document</span> <span class="cm-number">1</span> <span class="cm-keyword">of</span> <span class="cm-keyword">application</span> <span class="cm-string">"TextEdit"</span></span><br> <span role="presentation">        <span class="cm-keyword">--</span> <span class="cm-keyword">an</span> <span class="cm-keyword">object</span> <span class="cm-keyword">specifier</span></span><br> <span role="presentation">    <span class="cm-keyword">name</span> <span class="cm-keyword">of</span> <span class="cm-keyword">docRef</span> <span class="cm-keyword">--result:</span> <span class="cm-string">"New Report.rtf"</span></span><br> <span role="presentation">        <span class="cm-keyword">--</span> <span class="cm-keyword">name</span> <span class="cm-keyword">of</span> <span class="cm-keyword">the</span> <span class="cm-keyword">specified</span> <span class="cm-keyword">object</span></span><br> <span role="presentation"><span class="cm-keyword">end</span> <span class="cm-keyword">tell</span></span></pre><p class="md-end-block md-p"><span class="md-plain">在本脚本中，变量 </span><span class="md-pair-s" spellcheck="false"><code>docRef</code></span><span class="md-plain"> 是一个引用，其对象指定符指向应用程序 TextEdit 的第一个文档--在本例中，该文档恰好被命名为 "New Report.rtf"。不过， </span><span class="md-pair-s" spellcheck="false"><code>docRef</code></span><span class="md-plain"> 所指向的对象是可以改变的。如果打开第二个名为 "Second Report.rtf "的 TextEdit 文档，使其窗口位于前一个文档的前面，然后再次运行此脚本，它将返回现在最前面文档的名称 "Second Report.rtf"。</span></p><p class="md-end-block md-p"><span class="md-plain">您可以使用更具体的对象指定符来创建引用：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="apl" spellcheck="false"> <span role="presentation"><span class="cm-keyword">tell</span> <span class="cm-keyword">application</span> <span class="cm-string">"TextEdit"</span></span><br> <span role="presentation">    <span class="cm-keyword">set</span> <span class="cm-keyword">docRef</span> <span class="cm-keyword">to</span> <span class="cm-keyword">a</span> <span class="cm-keyword">reference</span> <span class="cm-keyword">to</span> <span class="cm-keyword">document</span> <span class="cm-string">"New Report.rtf"</span></span><br> <span role="presentation">    <span class="cm-keyword">--result:</span> <span class="cm-keyword">document</span> <span class="cm-string">"New Report.rtf"</span> <span class="cm-keyword">of</span> <span class="cm-keyword">application</span> <span class="cm-string">"TextEdit"</span></span><br> <span role="presentation">    <span class="cm-keyword">name</span> <span class="cm-keyword">of</span> <span class="cm-keyword">docRef</span> <span class="cm-keyword">--result:</span> <span class="cm-string">"New Report.rtf"</span></span><br> <span role="presentation"><span class="cm-keyword">end</span> <span class="cm-keyword">tell</span></span></pre><p class="md-end-block md-p"><span class="md-plain">如果您在打开第二个文档后运行此脚本，它仍会返回原始文档的名称 "New Report.rtf"（如果该文档存在）。</span> <span class="md-plain">使用 </span><span class="md-pair-s" spellcheck="false"><code>a reference to</code></span><span class="md-plain"> 操作符创建 </span><span class="md-pair-s" spellcheck="false"><code>reference</code></span><span class="md-plain"> 对象后，可以使用 </span><span class="md-pair-s" spellcheck="false"><code>contents</code></span><span class="md-plain"> 属性获取其引用对象的值。也就是说，使用 </span><span class="md-pair-s" spellcheck="false"><code>contents</code></span><span class="md-plain"> 属性会对引用的对象指定符进行求值。例如，在下面的脚本中，变量 </span><span class="md-pair-s" spellcheck="false"><code>myWindow</code></span><span class="md-plain"> 的内容就是窗口引用本身。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="apl" spellcheck="false"> <span role="presentation"><span class="cm-keyword">set</span> <span class="cm-keyword">myWindow</span> <span class="cm-keyword">to</span> <span class="cm-keyword">a</span> <span class="cm-keyword">ref</span> <span class="cm-keyword">to</span> <span class="cm-keyword">window</span> <span class="cm-string">"Q1.rtf"</span> <span class="cm-keyword">of</span> <span class="cm-keyword">application</span> <span class="cm-string">"TextEdit"</span></span><br> <span role="presentation"><span class="cm-keyword">myWindow</span></span><br> <span role="presentation">    <span class="cm-keyword">--</span> <span class="cm-keyword">result:</span> <span class="cm-keyword">window</span> <span class="cm-string">"Q1.rtf"</span> <span class="cm-keyword">of</span> <span class="cm-keyword">application</span> <span class="cm-string">"TextEdit"</span> (<span class="cm-keyword">object</span> <span class="cm-keyword">specifier</span>)</span><br> <span role="presentation"><span class="cm-keyword">contents</span> <span class="cm-keyword">of</span> <span class="cm-keyword">myWindow</span></span><br> <span role="presentation">    <span class="cm-keyword">--result:</span> <span class="cm-keyword">window</span> <span class="cm-keyword">id</span> <span class="cm-number">283</span> <span class="cm-keyword">of</span> <span class="cm-keyword">application</span> <span class="cm-string">"TextEdit"</span> (<span class="cm-keyword">an</span> <span class="cm-keyword">evaluated</span> <span class="cm-keyword">window</span>)</span><br> <span role="presentation"><span class="cm-keyword">get</span> <span class="cm-keyword">myWindow</span></span><br> <span role="presentation">    <span class="cm-keyword">--</span> <span class="cm-keyword">result:</span> <span class="cm-keyword">window</span> <span class="cm-string">"Q1.rtf"</span> <span class="cm-keyword">of</span> <span class="cm-keyword">application</span> <span class="cm-string">"TextEdit"</span> (<span class="cm-keyword">object</span> <span class="cm-keyword">specifier</span>)</span></pre><p class="md-end-block md-p"><span class="md-plain">请注意， </span><span class="md-pair-s" spellcheck="false"><code>get</code></span><span class="md-plain"> 命令的结果是返回引用的对象指定符，而不是将指定符解析为它所指定的对象。</span> <span class="md-plain">如果可以，AppleScript 将隐式取消引用对象（不使用 </span><span class="md-pair-s" spellcheck="false"><code>contents</code></span><span class="md-plain"> 属性），如下例所示：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="apl" spellcheck="false"> <span role="presentation"><span class="cm-keyword">set</span> <span class="cm-keyword">myWindow</span> <span class="cm-keyword">to</span> <span class="cm-keyword">a</span> <span class="cm-keyword">ref</span> <span class="cm-keyword">to</span> <span class="cm-keyword">window</span> <span class="cm-number">1</span> <span class="cm-keyword">of</span> <span class="cm-keyword">application</span> <span class="cm-string">"TextEdit"</span></span><br> <span role="presentation"><span class="cm-keyword">name</span> <span class="cm-keyword">of</span> <span class="cm-keyword">myWindow</span> <span class="cm-keyword">--result:</span> <span class="cm-string">"Q1.rtf"</span> (<span class="cm-keyword">if</span> <span class="cm-keyword">that</span> <span class="cm-keyword">is</span> <span class="cm-keyword">the</span> <span class="cm-keyword">first</span> <span class="cm-keyword">window</span><span class="cm-string">'s name)</span></span></pre><p class="md-end-block md-p"><span class="md-plain">有关信息，请参阅 </span><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCDJJDE"><span class="md-plain">reference</span></a></span><span class="md-plain"> 类的讨论部分。</span></p><h3 class="md-end-block md-heading"><span class="md-plain">2.5 Coercion (Object Conversion) - 强制（对象转换）</span></h3><p class="md-end-block md-p"><span class="md-plain">强制（也称为对象转换）是将对象从一个类转换为另一个类的过程。在上述两种情况下，AppleScript 都会将对象转换为不同的类：</span></p><ul class="ul-list" data-mark="-"><li class="md-list-item"><p class="md-end-block md-p"><span class="md-plain">作为对as运算符的响应我</span></p></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-plain">当对象的类别与特定命令或操作的预期类别不同时，系统会自动转换</span></p></li></ul><p class="md-end-block md-p"><span class="md-plain">并非所有类都可以强制为所有其他类类型。表 2-1 总结了 AppleScript 对常用类支持的强制。有关每种强制的详细信息，请参阅《</span><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-246384"><span class="md-plain">Class Reference</span></a></span><span class="md-plain">》中相应的类定义。</span></p><p class="md-end-block md-p"><span class="md-plain">AppleScript 提供了许多强制机制，这些机制可以是语言的内置部分，也可以通过标准附加脚本附加功能提供。您可以在脚本中的 </span><span class="md-pair-s" spellcheck="false"><code>tell</code></span><span class="md-plain"> 代码块之外使用这些强制。不过，应用程序类类型的强制可能取决于应用程序，因此需要一个针对应用程序的 </span><span class="md-pair-s" spellcheck="false"><code>tell</code></span><span class="md-plain"> 代码块。</span></p><p class="md-end-block md-p"><span class="md-pair-s" spellcheck="false"><code>as</code></span><span class="md-plain"> 操作符指定一个或一组特定的强制。例如，下面的语句将整数 </span><span class="md-pair-s" spellcheck="false"><code>2</code></span><span class="md-plain"> 强制转换为文本 </span><span class="md-pair-s" spellcheck="false"><code>"2"</code></span><span class="md-plain"> ，然后存储到变量 </span><span class="md-pair-s" spellcheck="false"><code>myText</code></span><span class="md-plain"> 中：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false"> <span role="presentation">set myText to 2 as text</span></pre><p class="md-end-block md-p"><span class="md-plain">如果您提供了错误类别的命令参数或操作数，AppleScript 会尽可能自动将操作数或参数强制转换为预期类别。如果无法进行转换，AppleScript 将报错。</span></p><p class="md-end-block md-p"><span class="md-plain">将 </span><span class="md-pair-s" spellcheck="false"><code>text</code></span><span class="md-plain"> 字符串强制转换为类 </span><span class="md-pair-s" spellcheck="false"><code>integer</code></span><span class="md-plain"> 、 </span><span class="md-pair-s" spellcheck="false"><code>number</code></span><span class="md-plain"> 或 </span><span class="md-pair-s" spellcheck="false"><code>real</code></span><span class="md-plain"> 的值时，AppleScript 会使用 "国际首选项 "中 "格式 "窗格的当前 "数字 "设置来决定在字符串中使用哪些分隔符。将字符串强制转换为 </span><span class="md-pair-s" spellcheck="false"><code>date</code></span><span class="md-plain"> 类的值时，AppleScript 会使用 "格式 "窗格中的当前 "日期 "设置。</span></p><p class="md-end-block md-p"> </p><figure class="md-table-fig table-figure"><table class="md-table"><thead><tr class="md-end-block"><th><span class="td-span"><span class="md-plain">类别转换</span></span></th><th><span class="td-span"><span class="md-plain">转换类</span></span></th><th><span class="td-span"><span class="md-plain">说明</span></span></th></tr></thead><tbody><tr class="md-end-block"><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>alias</code></span></span></td><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>list</code></span><span class="md-plain"> (single-item)</span><span class="md-pair-s" spellcheck="false"><code>text</code></span></span></td><td> </td></tr><tr class="md-end-block"><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>application</code></span></span></td><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>list</code></span><span class="md-plain"> (single-item)</span></span></td><td><span class="td-span"><span class="md-plain">这既是一个 AppleScript 类，也是一个应用程序类。</span></span></td></tr><tr class="md-end-block"><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>boolean</code></span></span></td><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>integer``list</code></span><span class="md-plain"> (single-item)</span><span class="md-pair-s" spellcheck="false"><code>text</code></span></span></td><td> </td></tr><tr class="md-end-block"><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>class</code></span></span></td><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>list</code></span><span class="md-plain"> (single-item) </span><span class="md-pair-s" spellcheck="false"><code>text</code></span></span></td><td> </td></tr><tr class="md-end-block"><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>constant</code></span></span></td><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>list</code></span><span class="md-plain"> (single-item) </span><span class="md-pair-s" spellcheck="false"><code>text</code></span></span></td><td> </td></tr><tr class="md-end-block"><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>date</code></span></span></td><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>list</code></span><span class="md-plain"> (single-item) </span><span class="md-pair-s" spellcheck="false"><code>text</code></span></span></td><td> </td></tr><tr class="md-end-block"><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>file</code></span></span></td><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>list</code></span><span class="md-plain"> (single-item) </span><span class="md-pair-s" spellcheck="false"><code>text</code></span></span></td><td> </td></tr><tr class="md-end-block"><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>integer</code></span></span></td><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>list</code></span><span class="md-plain"> (single-item) </span><span class="md-pair-s" spellcheck="false"><code>real text</code></span></span></td><td><span class="td-span"><span class="md-plain">将</span><span class="md-pair-s" spellcheck="false"><code>integer</code></span><span class="md-plain">强制转换为</span><span class="md-pair-s" spellcheck="false"><code>number</code></span><span class="md-plain">并不会改变它的类</span></span></td></tr><tr class="md-end-block"><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>list</code></span><span class="md-plain"> (single-item)</span></span></td><td><span class="td-span"><span class="md-plain">如果该项目不是列表的一部分，它可以被强制归入的任何类别</span></span></td><td> </td></tr><tr class="md-end-block"><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>list</code></span><span class="md-plain"> (multiple-item)</span></span></td><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>text</code></span><span class="md-plain"> 如果列表中的每个项目都可以被强制转换为 </span><span class="md-pair-s" spellcheck="false"><code>text</code></span><span class="md-plain"> 对象</span></span></td><td> </td></tr><tr class="md-end-block"><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>number</code></span></span></td><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>integer``list</code></span><span class="md-plain"> (single-item) </span><span class="md-pair-s" spellcheck="false"><code>real text</code></span></span></td><td><span class="td-span"><span class="md-plain">被标识为类</span><span class="md-pair-s" spellcheck="false"><code>number</code></span><span class="md-plain">的值是类</span><span class="md-pair-s" spellcheck="false"><code>integer</code></span><span class="md-plain">或类</span><span class="md-pair-s" spellcheck="false"><code>real</code></span><span class="md-plain">的真实值。</span></span></td></tr><tr class="md-end-block"><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>POSIX file</code></span></span></td><td><span class="td-span"><span class="md-plain">see </span><span class="md-pair-s" spellcheck="false"><code>file</code></span></span></td><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>POSIX file</code></span><span class="md-plain">是一个与</span><span class="md-pair-s" spellcheck="false"><code>file</code></span><span class="md-plain">类等价的伪类。</span></span></td></tr><tr class="md-end-block"><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>real</code></span></span></td><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>integer list</code></span><span class="md-plain"> (single-item)</span></span></td><td><span class="td-span"><span class="md-plain">在强制转换为</span><span class="md-pair-s" spellcheck="false"><code>integer</code></span><span class="md-plain">时，任何小数部分都被舍入。将</span><span class="md-pair-s" spellcheck="false"><code>real</code></span><span class="md-plain">强制转换为</span><span class="md-pair-s" spellcheck="false"><code>number</code></span><span class="md-plain">并不会改变它的类</span></span></td></tr><tr class="md-end-block"><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>record</code></span></span></td><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>list</code></span></span></td><td><span class="td-span"><span class="md-plain">所有标签都会在强制过程中丢失，生成的列表也无法强制回一条记录。</span></span></td></tr><tr class="md-end-block"><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>reference</code></span></span></td><td><span class="td-span"><span class="md-plain">被引用对象可以强制归属的任何类</span></span></td><td> </td></tr><tr class="md-end-block"><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>script</code></span></span></td><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>list</code></span><span class="md-plain"> (single-item)</span></span></td><td> </td></tr><tr class="md-end-block"><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>text</code></span></span></td><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>integer``list</code></span><span class="md-plain"> (single-item) </span><span class="md-pair-s" spellcheck="false"><code>real</code></span></span></td><td><span class="td-span"><span class="md-plain">只有当 </span><span class="md-pair-s" spellcheck="false"><code>text</code></span><span class="md-plain"> 对象代表一个适当的数字时，才能强制 </span><span class="md-pair-s" spellcheck="false"><code>integer</code></span><span class="md-plain"> 或 </span><span class="md-pair-s" spellcheck="false"><code>real</code></span><span class="md-plain"> 。</span></span></td></tr><tr class="md-end-block"><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>unit types</code></span></span></td><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>integer``list</code></span><span class="md-plain"> (single-item) </span><span class="md-pair-s" spellcheck="false"><code>real``text</code></span></span></td><td><span class="td-span"><span class="md-plain">可以强制在同一类别的单位类型之间转换，例如'英寸'到'公里'(长度)或'加仑'到'升'(液体体积)。</span></span></td></tr></tbody></table></figure><p class="md-end-block md-p"> </p><h3 class="md-end-block md-heading"><span class="md-plain">2.6 Scripting Additions - 添加脚本</span></h3><p class="md-end-block md-p"><span class="md-plain">脚本附加文件是一个文件或捆绑包，可提供处理程序，用于在脚本中执行命令和强制命令。</span></p><p class="md-end-block md-p"><span class="md-plain">本指南中描述的许多命令都在 macOS 的标准添加脚本中进行了定义。这些命令存储在 </span><span class="md-pair-s" spellcheck="false"><code>/System/Library/ScriptingAdditions</code></span><span class="md-plain"> 的文件 </span><span class="md-pair-s" spellcheck="false"><code>StandardAdditions.osax</code></span><span class="md-plain"> 中，任何脚本均可使用。你可以在脚本编辑器中打开该文件，查看标准附加功能的术语。</span></p><p class="md-end-block md-p"> </p><p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">Note:</span></strong></span><span class="md-plain"> A script can obtain the location of the Standard Additions with this script statement, which uses the </span><span class="md-pair-s" spellcheck="false"><code>path to (folder)</code></span><span class="md-plain"> command:</span> <span class="md-plain">注：脚本可通过该脚本语句获取标准附加文件的位置，该语句使用 </span><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW19"><span class="md-pair-s" spellcheck="false"><code>path to (folder)</code></span></a></span><span class="md-plain"> 命令：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="apl" spellcheck="false"> <span role="presentation"><span class="cm-keyword">path</span> <span class="cm-keyword">to</span> <span class="cm-keyword">scripting</span> <span class="cm-keyword">additions</span> <span class="cm-keyword">as</span> <span class="cm-keyword">text</span></span><br> <span role="presentation">    <span class="cm-keyword">--result:</span> <span class="cm-string">"Hard_Disk:System:Library:ScriptingAdditions:"</span></span></pre><p class="md-end-block md-p"><span class="md-plain">添加的脚本可嵌入捆绑的脚本小程序中，方法是将它们放在捆绑程序 </span><span class="md-pair-s" spellcheck="false"><code>Contents/Resources/</code></span><span class="md-plain"> 文件夹内名为 </span><span class="md-pair-s" spellcheck="false"><code>Scripting Additions</code></span><span class="md-plain"> 的文件夹中（注意 "脚本 "和 "添加 "之间的空格）。请注意，在编辑捆绑的小程序时，脚本编辑器不会查找嵌入的脚本附加文件。在脚本开发过程中，任何所需的脚本附加文件都必须正确安装在 </span><span class="md-pair-s" spellcheck="false"><code>/System/ScriptingAdditions</code></span><span class="md-plain"> 、 </span><span class="md-pair-s" spellcheck="false"><code>/Library/ScriptingAdditions</code></span><span class="md-plain"> 或 </span><span class="md-pair-s" spellcheck="false"><code>~/Library/ScriptingAdditions</code></span><span class="md-plain"> 中，以便脚本编辑器可以找到它们。</span></p><p class="md-end-block md-p"><span class="md-plain">开发人员可以创建自己的脚本添加，如技术说明 TN1164，</span><span class="md-pair-s"><em><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/technotes/tn1164/_index.html#//apple_ref/doc/uid/DTS10003003"><span class="md-plain">Scripting Additions for Mac OS X</span></a></span></em></span><span class="md-plain">中所述。有关相关概念信息，请参阅 </span><span class="md-pair-s"><em><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptX/AppleScriptX.html#//apple_ref/doc/uid/10000156i"><span class="md-plain">AppleScript Overview</span></a></span></em></span><span class="md-plain"> ，尤其是</span><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptX/Concepts/osa.html#//apple_ref/doc/uid/TP40001571"><span class="md-plain">Open Scripting Architecture</span></a></span><span class="md-plain">一章。</span></p><h3 class="md-end-block md-heading"><span class="md-plain">2.7 Commands Overview - 命令概述</span></h3><p class="md-end-block md-p"><span class="md-plain">命令是 AppleScript 语句中用于请求执行操作的一个单词或一系列单词。每条命令都针对一个目标，即响应命令的对象。目标通常是应用程序对象（存储在应用程序或其文档中并由应用程序管理的对象，如窗口或文档）或 macOS 中的对象。不过，它也可以是 </span><span class="md-pair-s" spellcheck="false"><code>script</code></span><span class="md-plain"> 对象或当前脚本中的一个值。</span></p><p class="md-end-block md-p"><span class="md-plain">命令通常会返回结果。例如， </span><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW12"><span class="md-plain">display dialog</span></a></span><span class="md-plain"> 命令会返回一条记录，其中可能包含文本、按钮名称和其他信息。脚本可以检查这条记录，以确定下一步的操作。你可以将命令的结果赋值给你定义的变量，或通过预定义的 AppleScript </span><span class="md-pair-s" spellcheck="false"><code>result</code></span><span class="md-plain"> 变量来访问它。</span></p><p class="md-end-block md-p"> </p><h4 class="md-end-block md-heading"><span class="md-plain">2.7.1 Types of Commands - 命令类型</span></h4><p class="md-end-block md-p"><span class="md-plain">脚本可以使用以下几种命令：</span></p><ul class="ul-list" data-mark="-"><li class="md-list-item"><p class="md-end-block md-p"><span class="md-plain">AppleScript 命令是内置于 AppleScript 语言中的命令。目前有五个这样的命令： </span><span class="md-pair-s" spellcheck="false"><code>get</code></span><span class="md-plain"> 、 </span><span class="md-pair-s" spellcheck="false"><code>set</code></span><span class="md-plain"> 、 </span><span class="md-pair-s" spellcheck="false"><code>count</code></span><span class="md-plain"> 、 </span><span class="md-pair-s" spellcheck="false"><code>copy</code></span><span class="md-plain"> 和 </span><span class="md-pair-s" spellcheck="false"><code>run</code></span><span class="md-plain"> 。除了 </span><span class="md-pair-s" spellcheck="false"><code>copy</code></span><span class="md-plain"> 之外，这些命令中的每一个也可以由应用程序实现。也就是说，该命令有一个适用于 AppleScript 对象的 AppleScript 版本，但应用程序可以定义自己的版本来适用于它定义的对象类型。</span></p></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-plain">脚本添加命令是通过</span><span class="md-meta-i-c md-link"><a href="applewebdata://BE961DC6-7ABA-4896-9287-4947EA567604#//apple_ref/doc/uid/TP40000983-CH218-SW3"><span class="md-plain">Scripting Additions</span></a></span><span class="md-plain">中描述的机制实现的命令。尽管任何人都可以创建脚本添加（请参阅技术说明 TN1164，</span><span class="md-pair-s"><em><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/technotes/tn1164/_index.html#//apple_ref/doc/uid/DTS10003003"><span class="md-plain">Scripting Additions for Mac OS X</span></a></span></em></span><span class="md-plain">），但本指南仅记录来自 Apple 作为 macOS 的一部分提供的标准添加的脚本添加命令。这些命令适用于所有脚本。</span></p></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-plain">用户自定义命令是由 </span><span class="md-pair-s" spellcheck="false"><code>script</code></span><span class="md-plain"> 对象中定义的处理程序执行的命令。要在 </span><span class="md-pair-s" spellcheck="false"><code>tell</code></span><span class="md-plain"> 语句之外调用用户定义的命令，只需使用该命令的名称并为其所需的任何参数提供值即可。命令将使用当前脚本作为目标。</span></p><p class="md-end-block md-p"><span class="md-plain">要在 </span><span class="md-pair-s" spellcheck="false"><code>tell</code></span><span class="md-plain"> 语句中调用用户定义的命令，请参阅在 </span><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/conceptual/ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW1"><span class="md-plain">Calling Handlers in a tell Statement</span></a></span><span class="md-plain">。</span></p></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-plain">应用程序命令是由可编写脚本的应用程序定义的命令，用于访问可编写脚本的功能。它们通常包含在针对应用程序的 </span><span class="md-pair-s" spellcheck="false"><code>tell</code></span><span class="md-plain"> 语句中。通过在脚本编辑器中检查应用程序的字典，可以确定应用程序支持哪些命令。</span> <span class="md-plain">macOS 随附的可编写脚本的应用程序，如 Finder 和 System Events 应用程序（位于 </span><span class="md-pair-s" spellcheck="false"><code>/System/Library/CoreServices</code></span><span class="md-plain"> ），提供了许多有用的脚本命令。</span></p><p class="md-end-block md-p"><span class="md-plain">第三方脚本应用程序也提供可以在脚本中使用的命令。许多应用程序支持 TN2106 技术注释《</span><span class="md-pair-s"><em><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/technotes/tn2002/tn2106.html#//apple_ref/doc/uid/DTS10003199"><span class="md-plain">Scripting Interface Guidelines</span></a></span></em></span><span class="md-plain">》中描述的全部或部分标准命令。这些命令包括 </span><span class="md-pair-s" spellcheck="false"><code>delete</code></span><span class="md-plain"> 、 </span><span class="md-pair-s" spellcheck="false"><code>duplicate</code></span><span class="md-plain"> 、 </span><span class="md-pair-s" spellcheck="false"><code>exists</code></span><span class="md-plain"> 和 </span><span class="md-pair-s" spellcheck="false"><code>move</code></span><span class="md-plain"> ，以及 AppleScript 命令的应用程序实现，如 </span><span class="md-pair-s" spellcheck="false"><code>get</code></span><span class="md-plain"> 和 </span><span class="md-pair-s" spellcheck="false"><code>set</code></span><span class="md-plain"> 。</span></p></li></ul><h4 class="md-end-block md-heading"><span class="md-plain">2.7.2 Target - 目标</span></h4><p class="md-end-block md-p"><span class="md-plain">有两种方法可以显式指定对象作为命令的目标：将其作为命令的直接参数提供（在下一节中介绍）或将其指定为 </span><span class="md-pair-s" spellcheck="false"><code>tell</code></span><span class="md-plain"> 语句的目标包含该命令。如果脚本未使用 </span><span class="md-pair-s" spellcheck="false"><code>tell</code></span><span class="md-plain"> 语句显式指定目标，并且该目标不是由脚本中的处理程序或 AppleScript 本身处理，则会将其发送到继承链中的下一个对象（请参阅 </span><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/conceptual/ASLR_script_objects.html#//apple_ref/doc/uid/TP40000983-CH207-SW15"><span class="md-plain">The AppleScript Inheritance Chain</span></a></span><span class="md-plain">）。</span></p><p class="md-end-block md-p"><span class="md-plain">在下面的脚本中， </span><span class="md-pair-s" spellcheck="false"><code>get</code></span><span class="md-plain"> 命令的目标是对象指定符 </span><span class="md-pair-s" spellcheck="false"><code>name of first window</code></span><span class="md-plain"> 。由于外层的 </span><span class="md-pair-s" spellcheck="false"><code>tell</code></span><span class="md-plain"> 语句指定了 Finder 应用程序，因此完整的指定符是 </span><span class="md-pair-s" spellcheck="false"><code>name of first window of application "Finder"</code></span><span class="md-plain"> ，而获取和返回所请求信息的正是 Finder 应用程序。</span></p><p class="md-end-block md-p"> </p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="apl" spellcheck="false"> <span role="presentation"><span class="cm-keyword">tell</span> <span class="cm-keyword">application</span> <span class="cm-string">"Finder"</span></span><br> <span role="presentation">    <span class="cm-keyword">get</span> <span class="cm-keyword">name</span> <span class="cm-keyword">of</span> <span class="cm-keyword">first</span> <span class="cm-keyword">window</span></span><br> <span role="presentation"><span class="cm-keyword">end</span> <span class="cm-keyword">tell</span></span></pre><p class="md-end-block md-p"><span class="md-plain">当命令以应用程序为目标时，结果可能是应用程序对象。如果是这样，以结果对象为目标的后续语句将被发送到应用程序。</span></p><p class="md-end-block md-p"><span class="md-plain">脚本也可以通过使用 </span><span class="md-pair-s" spellcheck="false"><code>Note</code></span><span class="md-plain"> 语句导入的应用程序命令来隐式地指定目标。例如，下面脚本中的 </span><span class="md-pair-s" spellcheck="false"><code>extract address</code></span><span class="md-plain"> 命令以 Mail 应用程序为目标，因为该命令是从 Mail 中导入的：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="apl" spellcheck="false"> <span role="presentation"><span class="cm-keyword">use</span> <span class="cm-keyword">application</span> <span class="cm-string">"Mail"</span></span><br> <span role="presentation"><span class="cm-keyword">extract</span> <span class="cm-keyword">address</span> <span class="cm-keyword">from</span> <span class="cm-string">"John Doe &lt;jdoe@example.com&gt;"</span></span></pre><p class="md-end-block md-p"> </p><p class="md-end-block md-p"> </p><h4 class="md-end-block md-heading"><span class="md-plain">2.7.3 Direct Parameter - 直接参数</span></h4><p class="md-end-block md-p"><span class="md-plain">直接参数是一个值，通常是一个对象说明符，紧挨着命令出现，用于指定命令的目标。并非所有命令都有直接参数。如果命令可以有直接参数，则会在命令定义中注明。</span></p><p class="md-end-block md-p"><span class="md-plain">在下面的语句中，对象指定符 </span><span class="md-pair-s" spellcheck="false"><code>last file of window 1 of application "Finder"</code></span><span class="md-plain"> 是 </span><span class="md-pair-s" spellcheck="false"><code>duplicate</code></span><span class="md-plain"> 命令的直接参数：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false"> <span role="presentation">duplicate last file of window 1 of application "Finder"</span></pre><p class="md-end-block md-p"><span class="md-plain">直接参数通常紧接在命令之后，但也可能紧接在命令之前。这对于某些命令来说更容易阅读，例如本例中的 </span><span class="md-pair-s" spellcheck="false"><code>exists</code></span><span class="md-plain"> ：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="apl" spellcheck="false"> <span role="presentation"><span class="cm-keyword">if</span> <span class="cm-keyword">file</span> <span class="cm-string">"semaphore"</span> <span class="cm-keyword">of</span> <span class="cm-keyword">application</span> <span class="cm-string">"Finder"</span> <span class="cm-keyword">exists</span> <span class="cm-keyword">then</span></span><br> <span role="presentation">   <span class="cm-keyword">--</span> <span class="cm-keyword">continue</span> <span class="cm-keyword">processing</span><span class="cm-operator cm-apl-innerProduct">...</span></span><br> <span role="presentation"><span class="cm-keyword">end</span> <span class="cm-keyword">if</span></span></pre><p class="md-end-block md-p"><span class="md-pair-s" spellcheck="false"><code>tell</code></span><span class="md-plain"> 语句为其中包含的所有命令指定了默认目标，因此直接参数是可选的。下面示例的结果与上例相同：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="apl" spellcheck="false"> <span role="presentation"><span class="cm-keyword">tell</span> <span class="cm-keyword">last</span> <span class="cm-keyword">file</span> <span class="cm-keyword">of</span> <span class="cm-keyword">window</span> <span class="cm-number">1</span> <span class="cm-keyword">of</span> <span class="cm-keyword">application</span> <span class="cm-string">"Finder"</span></span><br> <span role="presentation">    <span class="cm-keyword">duplicate</span></span><br> <span role="presentation"><span class="cm-keyword">end</span> <span class="cm-keyword">tell</span></span></pre><p class="md-end-block md-p"> </p><h4 class="md-end-block md-heading"><span class="md-plain">2.7.4 Parameters That Specify Locations - 指定位置的参数</span></h4><p class="md-end-block md-p"><span class="md-plain">许多命令都有指定位置的参数。位置可以是插入点，也可以是其他对象。插入点是可以添加对象的位置。</span> <span class="md-plain">在下面的示例中， </span><span class="md-pair-s" spellcheck="false"><code>to</code></span><span class="md-plain"> 参数指定了要移动第一段的位置。 </span><span class="md-pair-s" spellcheck="false"><code>duplicate</code></span><span class="md-plain"> 命令中 </span><span class="md-pair-s" spellcheck="false"><code>to</code></span><span class="md-plain"> 参数的值是相对对象指定符 </span><span class="md-pair-s" spellcheck="false"><code>before paragraph 4</code></span><span class="md-plain"> ，它是一个插入点。AppleScript 用 </span><span class="md-pair-s" spellcheck="false"><code>tell</code></span><span class="md-plain"> 语句的目标 </span><span class="md-pair-s" spellcheck="false"><code>front document of application "TextEdit"</code></span><span class="md-plain"> 来完成指定。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="apl" spellcheck="false"> <span role="presentation"><span class="cm-keyword">tell</span> <span class="cm-keyword">front</span> <span class="cm-keyword">document</span> <span class="cm-keyword">of</span> <span class="cm-keyword">application</span> <span class="cm-string">"TextEdit"</span></span><br> <span role="presentation">    <span class="cm-keyword">duplicate</span> <span class="cm-keyword">paragraph</span> <span class="cm-number">1</span> <span class="cm-keyword">to</span> <span class="cm-keyword">before</span> <span class="cm-keyword">paragraph</span> <span class="cm-number">4</span></span><br> <span role="presentation"><span class="cm-keyword">end</span> <span class="cm-keyword">tell</span></span></pre><p class="md-end-block md-p"><span class="md-pair-s" spellcheck="false"><code>paragraph 1</code></span><span class="md-plain"> 和 </span><span class="md-pair-s" spellcheck="false"><code>before paragraph 4</code></span><span class="md-plain"> 分别称为索引和相对引用。更多信息，请参阅参考</span><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/reference/ASLR_reference_forms.html#//apple_ref/doc/uid/TP40000983-CH4g-120522"><span class="md-plain">Reference Forms</span></a></span><span class="md-plain">。</span></p><p class="md-end-block md-p"> </p><h3 class="md-end-block md-heading"><span class="md-plain">2.8 AppleScript Error Handling - AppleScript 错误处理</span></h3><p class="md-end-block md-p"><span class="md-plain">在脚本执行过程中，由于与 macOS 的交互、应用脚本命令中遇到的问题或脚本本身的语句导致的问题，可能会发生错误。发生错误时，AppleScript 会停止在当前位置执行，发出错误信号，并在调用链中查找可以处理错误的脚本语句。也就是说，它会查找发生错误位置周围最近的错误处理代码块。</span></p><p class="md-end-block md-p"><span class="md-plain">脚本可以通过将可能遇到错误的语句括在 </span><span class="md-pair-s" spellcheck="false"><code>try</code></span><span class="md-plain"> 语句中来处理错误。 </span><span class="md-pair-s" spellcheck="false"><code>try</code></span><span class="md-plain"> 语句包括一个 </span><span class="md-pair-s" spellcheck="false"><code>on error</code></span><span class="md-plain"> 部分，如果发生错误，该部分将被调用。AppleScript 会将错误信息（包括错误编号和错误信息）传递给 </span><span class="md-pair-s" spellcheck="false"><code>on error</code></span><span class="md-plain"> 部分。这样，脚本就可以检查错误编号并显示相关信息。</span></p><p class="md-end-block md-p"><span class="md-plain">如果错误发生在未提供 </span><span class="md-pair-s" spellcheck="false"><code>try</code></span><span class="md-plain"> 语句的处理程序中，AppleScript 会查找调用处理程序的外层 </span><span class="md-pair-s" spellcheck="false"><code>try</code></span><span class="md-plain"> 语句。如果调用链中没有任何调用包含在 </span><span class="md-pair-s" spellcheck="false"><code>try</code></span><span class="md-plain"> 语句中，AppleScript 会停止脚本的执行并显示错误信息（对于 -128 以外的任何错误编号，如下所述）。</span></p><p class="md-end-block md-p"><span class="md-plain">脚本可以使用 </span><span class="md-pair-s" spellcheck="false"><code>error</code></span><span class="md-plain"> 语句直接发出错误信号。这样做会调用 AppleScript 的错误处理机制，该机制会查找外层的 </span><span class="md-pair-s" spellcheck="false"><code>try</code></span><span class="md-plain"> 语句来处理错误。</span></p><p class="md-end-block md-p"><span class="md-plain">有些 "错误 "是命令正常运行的结果。例如，如果用户点击取消按钮， </span><span class="md-pair-s" spellcheck="false"><code>display dialog</code></span><span class="md-plain"> 和 </span><span class="md-pair-s" spellcheck="false"><code>choose file</code></span><span class="md-plain"> 等命令会发出 </span><span class="md-pair-s" spellcheck="false"><code>error –128</code></span><span class="md-plain"> （用户取消）信号。脚本通常会处理用户取消错误，以确保正常运行。有关如何处理的示例，请参阅 </span><span class="md-pair-s" spellcheck="false"><code>display dialog</code></span><span class="md-plain"> 命令的示例部分。如果脚本中没有处理 -128 错误的 </span><span class="md-pair-s" spellcheck="false"><code>try</code></span><span class="md-plain"> 语句，AppleScript 会停止脚本的执行，但不会显示任何错误信息。</span></p><p class="md-end-block md-p"><span class="md-plain">有关相关信息，请参阅结果 </span><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/conceptual/ASLR_lexical_conventions.html#//apple_ref/doc/uid/TP40000983-CH214-SW19"><span class="md-plain">Results</span></a></span><span class="md-plain">, </span><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/reference/ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-129657"><span class="md-plain">error Statements</span></a></span><span class="md-plain">, </span><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/reference/ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-128973"><span class="md-plain">try Statements</span></a></span><span class="md-plain">, </span><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/reference/ASLR_error_codes.html#//apple_ref/doc/uid/TP40000983-CH220-SW5"><span class="md-plain">Error Numbers and Error Messages</span></a></span><span class="md-plain">, and </span><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/reference/ASLR_error_xmpls.html#//apple_ref/doc/uid/TP40000983-CH221-SW1"><span class="md-plain">Working with Errors</span></a></span><span class="md-plain">.</span></p><p class="md-end-block md-p"> </p><h3 class="md-end-block md-heading"><span class="md-plain">2.9 Global Constants in AppleScript - AppleScript 中的全局常量</span></h3><p class="md-end-block md-p"><span class="md-plain">AppleScript 定义了许多全局常量，你可以在脚本的任何地方使用它们。</span></p><p class="md-end-block md-p"> </p><h4 class="md-end-block md-heading"><span class="md-plain">2.9.1 AppleScript Constant - AppleScript 常量</span></h4><p class="md-end-block md-p"><span class="md-plain">通过全局常量 </span><span class="md-pair-s" spellcheck="false"><code>AppleScript</code></span><span class="md-plain"> ，您可以访问在整个脚本中使用的属性。</span></p><p class="md-end-block md-p"><span class="md-plain">如</span><span class="md-meta-i-c md-link"><a href="applewebdata://BE961DC6-7ABA-4896-9287-4947EA567604#//apple_ref/doc/uid/TP40000983-CH218-SW6"><span class="md-plain">version</span></a></span><span class="md-plain">部分所示，你可以使用 </span><span class="md-pair-s" spellcheck="false"><code>AppleScript</code></span><span class="md-plain"> 标识符本身来区分 AppleScript 属性和当前目标的同名属性。</span></p><p class="md-end-block md-p"><span class="md-plain">下文将介绍 </span><span class="md-pair-s" spellcheck="false"><code>AppleScript</code></span><span class="md-plain"> 的其他属性。</span></p><p class="md-end-block md-p"> </p><h5 class="md-end-block md-heading"><span class="md-plain">2.9.1.1 pi</span></h5><p class="md-end-block md-p"><span class="md-plain">这个 </span><span class="md-pair-s" spellcheck="false"><code>mathematical</code></span><span class="md-plain"> 值表示圆周长与直径之比。它被定义为实数，值为 3.14159265359。</span></p><p class="md-end-block md-p"><span class="md-plain">例如，下面的语句计算半径为 7 的圆的面积：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false"> <span role="presentation">set circleArea to pi * 7 * 7 --result: 153.9380400259</span></pre><p class="md-end-block md-p"> </p><h5 class="md-end-block md-heading"><span class="md-plain">2.9.1.2 result - 返回</span></h5><p class="md-end-block md-p"><span class="md-plain">执行语句时，AppleScript 会将结果值（如果有）存储到预定义属性 </span><span class="md-pair-s" spellcheck="false"><code>result</code></span><span class="md-plain"> 中。在执行另一条产生值的语句之前，该值一直保持不变。在执行产生结果的语句之前， </span><span class="md-pair-s" spellcheck="false"><code>result</code></span><span class="md-plain"> 的值是未定义的。您可以在脚本窗口的 "结果 "窗格中查看脚本编辑器中的结果。</span></p><p class="md-end-block md-p"><span class="md-plain">注意：当脚本执行过程中发生错误时，AppleScript 会发出错误信号。它不会在 </span><span class="md-pair-s" spellcheck="false"><code>result</code></span><span class="md-plain"> 属性中返回错误信息。有关详细信息，请参阅 </span><span class="md-meta-i-c md-link"><a href="applewebdata://BE961DC6-7ABA-4896-9287-4947EA567604#//apple_ref/doc/uid/TP40000983-CH218-SW10"><span class="md-plain">AppleScript Error Handling</span></a></span><span class="md-plain">。</span></p><p class="md-end-block md-p"> </p><p class="md-end-block md-p"> </p><h5 class="md-end-block md-heading"><span class="md-plain">2.9.1.3 Text Constants - 文本常量</span></h5><p class="md-end-block md-p"><span class="md-plain">AppleScript 定义了文本属性 </span><span class="md-pair-s" spellcheck="false"><code>space</code></span><span class="md-plain"> , </span><span class="md-pair-s" spellcheck="false"><code>tab</code></span><span class="md-plain"> , </span><span class="md-pair-s" spellcheck="false"><code>return</code></span><span class="md-plain"> , </span><span class="md-pair-s" spellcheck="false"><code>linefeed</code></span><span class="md-plain"> 和 </span><span class="md-pair-s" spellcheck="false"><code>quote</code></span><span class="md-plain"> 。使用这些属性作为文本常量，可以有效地表示空白或双引号 ( </span><span class="md-pair-s" spellcheck="false"><code>"</code></span><span class="md-plain"> ) 字符。 </span><span class="md-pair-s" spellcheck="false"><code>text</code></span><span class="md-plain"> 类的 "特殊字符串字符 "部分对它们进行了描述。</span></p><p class="md-end-block md-p"> </p><h5 class="md-end-block md-heading"><span class="md-plain">2.9.1.4 text item delimiters - 文本项分隔符</span></h5><p class="md-end-block md-p"><span class="md-plain">AppleScript 提供了用于处理文本的 </span><span class="md-pair-s" spellcheck="false"><code>text item delimiters</code></span><span class="md-plain"> 属性。该属性由一系列字符串组成，当 AppleScript 将列表强制转换为文本或从文本字符串中获取文本项时，这些字符串将用作分隔符。当获取 </span><span class="md-pair-s" spellcheck="false"><code>text items</code></span><span class="md-plain"> 文本时，所有字符串都用作分隔符。将列表强制转换为文本时，第一项将用作分隔符。</span></p><p class="md-end-block md-p"><span class="md-plain">注意：在 OS X Snow Leopard v10.6 之前，AppleScript 在获取 </span><span class="md-pair-s" spellcheck="false"><code>text items</code></span><span class="md-plain"> 时只使用列表中的第一个分隔符。</span></p><p class="md-end-block md-p"><span class="md-plain">由于 </span><span class="md-pair-s" spellcheck="false"><code>text item delimiters</code></span><span class="md-plain"> 尊重 AppleScript 2.0 中的 </span><span class="md-pair-s" spellcheck="false"><code>considering</code></span><span class="md-plain"> 和 </span><span class="md-pair-s" spellcheck="false"><code>ignoring</code></span><span class="md-plain"> 属性，因此默认情况下分隔符不区分大小写。以前，它们总是区分大小写。要执行以前的行为，请添加一条明确的 </span><span class="md-pair-s" spellcheck="false"><code>considering case</code></span><span class="md-plain"> 语句。</span></p><p class="md-end-block md-p"><span class="md-plain">您可以获取和设置 </span><span class="md-pair-s" spellcheck="false"><code>text item delimiters</code></span><span class="md-plain"> 属性的当前值。通常情况下，AppleScript 不使用任何分隔符。例如，如果文本分隔符没有明确更改，语句</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false"> <span role="presentation">{"bread", "milk", "butter", 10.45}  as string</span></pre><p class="md-end-block md-p"><span class="md-plain">返回以下内容：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false"> <span role="presentation">"breadmilkbutter10.45"</span></pre><p class="md-end-block md-p"><span class="md-plain">为便于打印或显示，通常最好将 </span><span class="md-pair-s" spellcheck="false"><code>text item delimiters</code></span><span class="md-plain"> 设置为更易于阅读的值。例如，脚本</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="apl" spellcheck="false"> <span role="presentation"><span class="cm-keyword">set</span> <span class="cm-keyword">AppleScript</span><span class="cm-string">'s text item delimiters to {", "}</span></span><br> <span role="presentation">{<span class="cm-string">"bread"</span><span class="cm-function cm-apl-catenate">,</span> <span class="cm-string">"milk"</span><span class="cm-function cm-apl-catenate">,</span> <span class="cm-string">"butter"</span><span class="cm-function cm-apl-catenate">,</span> <span class="cm-number">10.45</span>}  <span class="cm-keyword">as</span> <span class="cm-keyword">string</span></span></pre><p class="md-end-block md-p"><span class="md-plain">返回此结果：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false"> <span role="presentation">"bread, milk, butter, 10.45"</span></pre><p class="md-end-block md-p"><span class="md-pair-s" spellcheck="false"><code>text item delimiters</code></span><span class="md-plain"> 属性可用于从路径名中提取单个名称。例如，脚本</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="apl" spellcheck="false"> <span role="presentation"><span class="cm-keyword">set</span> <span class="cm-keyword">AppleScript</span><span class="cm-string">'s text item delimiters to {":"}</span></span><br> <span role="presentation"><span class="cm-keyword">get</span> <span class="cm-keyword">last</span> <span class="cm-keyword">text</span> <span class="cm-keyword">item</span> <span class="cm-keyword">of</span> <span class="cm-string">"Hard Disk:CD Contents:Release Notes"</span></span></pre><p class="md-end-block md-p"> </p><p class="md-end-block md-p"><span class="md-plain">返回结果 </span><span class="md-pair-s" spellcheck="false"><code>"Release Notes"</code></span><span class="md-plain"> 。</span> <span class="md-plain">如果在脚本编辑器中更改了 </span><span class="md-pair-s" spellcheck="false"><code>text item delimiters</code></span><span class="md-plain"> 属性，在恢复其先前值或退出脚本编辑器并再次启动脚本编辑器之前，该属性将保持不变。如果在脚本应用程序中更改 </span><span class="md-pair-s" spellcheck="false"><code>text item delimiters</code></span><span class="md-plain"> ，则该应用程序中的分隔符将保持不变，直到恢复其先前的值或脚本应用程序退出为止；但脚本编辑器或运行的其他脚本应用程序中的分隔符不会更改。</span> <span class="md-plain">如果出现错误，脚本通常会使用错误处理程序将 </span><span class="md-pair-s" spellcheck="false"><code>text item delimiters</code></span><span class="md-plain"> 属性重置为原来的值（有关处理错误的更多信息，请参阅 </span><span class="md-meta-i-c md-link"><a href="applewebdata://BE961DC6-7ABA-4896-9287-4947EA567604#//apple_ref/doc/uid/TP40000983-CH218-SW10"><span class="md-plain">AppleScript Error Handling</span></a></span><span class="md-plain">）：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="apl" spellcheck="false"> <span role="presentation"><span class="cm-keyword">set</span> <span class="cm-keyword">savedDelimiters</span> <span class="cm-keyword">to</span> <span class="cm-keyword">AppleScript</span><span class="cm-string">'s text item delimiters</span></span><br> <span role="presentation"><span class="cm-keyword">try</span></span><br> <span role="presentation">    <span class="cm-keyword">set</span> <span class="cm-keyword">AppleScript</span><span class="cm-string">'s text item delimiters to {"**"}</span></span><br> <span role="presentation">    <span class="cm-keyword">--other</span> <span class="cm-keyword">script</span> <span class="cm-keyword">statements</span><span class="cm-operator cm-apl-innerProduct">...</span></span><br> <span role="presentation">    <span class="cm-keyword">--now</span> <span class="cm-keyword">reset</span> <span class="cm-keyword">the</span> <span class="cm-keyword">text</span> <span class="cm-keyword">item</span> <span class="cm-keyword">delimiters:</span></span><br> <span role="presentation">    <span class="cm-keyword">set</span> <span class="cm-keyword">AppleScript</span><span class="cm-string">'s text item delimiters to savedDelimiters</span></span><br> <span role="presentation"><span class="cm-keyword">on</span> <span class="cm-keyword">error</span> <span class="cm-keyword">m</span> <span class="cm-keyword">number</span> <span class="cm-keyword">n</span></span><br> <span role="presentation">    <span class="cm-keyword">--also</span> <span class="cm-keyword">reset</span> <span class="cm-keyword">text</span> <span class="cm-keyword">item</span> <span class="cm-keyword">delimiters</span> <span class="cm-keyword">in</span> <span class="cm-keyword">case</span> <span class="cm-keyword">of</span> <span class="cm-keyword">an</span> <span class="cm-keyword">error:</span></span><br> <span role="presentation">    <span class="cm-keyword">set</span> <span class="cm-keyword">AppleScript</span><span class="cm-string">'s text item delimiters to savedDelimiters</span></span><br> <span role="presentation">    <span class="cm-keyword">--and</span> <span class="cm-keyword">resignal</span> <span class="cm-keyword">the</span> <span class="cm-keyword">error:</span></span><br> <span role="presentation">    <span class="cm-keyword">error</span> <span class="cm-keyword">m</span> <span class="cm-keyword">number</span> <span class="cm-keyword">n</span></span><br> <span role="presentation"><span class="cm-keyword">end</span> <span class="cm-keyword">try</span></span><br> <span role="presentation">​</span></pre><p class="md-end-block md-p"> </p><h5 class="md-end-block md-heading"><span class="md-plain">2.9.1.5 version - 版本</span></h5><p class="md-end-block md-p"><span class="md-plain">此属性提供 AppleScript 的当前版本。下面的脚本演示了如何检查版本是否大于或等于 1.9 版。 </span><span class="md-pair-s" spellcheck="false"><code>if</code></span><span class="md-plain"> 语句被包裹在 </span><span class="md-pair-s" spellcheck="false"><code>considering numeric strings</code></span><span class="md-plain"> 语句中，这样 AppleScript 的版本（如 </span><span class="md-pair-s" spellcheck="false"><code>1.10.6</code></span><span class="md-plain"> ）就会比 </span><span class="md-pair-s" spellcheck="false"><code>1.9</code></span><span class="md-plain"> 大。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="apl" spellcheck="false"> <span role="presentation"><span class="cm-keyword">considering</span> <span class="cm-keyword">numeric</span> <span class="cm-keyword">strings</span></span><br> <span role="presentation">    <span class="cm-keyword">if</span> <span class="cm-keyword">version</span> <span class="cm-keyword">of</span> <span class="cm-keyword">AppleScript</span> <span class="cm-keyword">as</span> <span class="cm-keyword">string</span> <span class="cm-function cm-apl-greaterThanOrEqual">≥</span> <span class="cm-string">"1.9"</span> <span class="cm-keyword">then</span></span><br> <span role="presentation">        <span class="cm-keyword">--</span> <span class="cm-keyword">Perform</span> <span class="cm-keyword">operations</span> <span class="cm-keyword">that</span> <span class="cm-keyword">depend</span> <span class="cm-keyword">on</span> <span class="cm-keyword">version</span> <span class="cm-number">1.9</span> <span class="cm-keyword">or</span> <span class="cm-keyword">greater</span></span><br> <span role="presentation">    <span class="cm-keyword">else</span></span><br> <span role="presentation">        <span class="cm-keyword">--</span> <span class="cm-keyword">Handle</span> <span class="cm-keyword">case</span> <span class="cm-keyword">where</span> <span class="cm-keyword">version</span> <span class="cm-keyword">is</span> <span class="cm-keyword">not</span> <span class="cm-keyword">high</span> <span class="cm-keyword">enough</span></span><br> <span role="presentation">    <span class="cm-keyword">end</span> <span class="cm-keyword">if</span></span><br> <span role="presentation"><span class="cm-keyword">end</span> <span class="cm-keyword">considering</span></span></pre><p class="md-end-block md-p"><span class="md-plain">应用程序可以拥有自己的 </span><span class="md-pair-s" spellcheck="false"><code>version</code></span><span class="md-plain"> 属性，因此要明确访问 AppleScript 版本，可以使用 </span><span class="md-pair-s" spellcheck="false"><code>version of AppleScript</code></span><span class="md-plain"> 短语。这将在针对另一个应用程序的 </span><span class="md-pair-s" spellcheck="false"><code>tell</code></span><span class="md-plain"> 代码块中起作用，例如下面的代码：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="apl" spellcheck="false"> <span role="presentation"><span class="cm-keyword">tell</span> <span class="cm-keyword">application</span> <span class="cm-string">"Finder"</span></span><br> <span role="presentation">    <span class="cm-keyword">version</span> <span class="cm-keyword">--result:</span> <span class="cm-string">"10.5.1"</span></span><br> <span role="presentation">    <span class="cm-keyword">version</span> <span class="cm-keyword">of</span> <span class="cm-keyword">AppleScript</span> <span class="cm-keyword">--result:</span> <span class="cm-string">"2.0"</span></span><br> <span role="presentation"><span class="cm-keyword">end</span> <span class="cm-keyword">tell</span></span><br> <span role="presentation">​</span></pre><p class="md-end-block md-p"> </p><h4 class="md-end-block md-heading"><span class="md-plain">2.9.2 current application Constant - current application常量</span></h4><p class="md-end-block md-p"><span class="md-pair-s" spellcheck="false"><code>current application</code></span><span class="md-plain"> 常量指的是执行当前 AppleScript 脚本的应用程序（例如脚本编辑器）。由于当前应用程序是 AppleScript 的父应用程序（请参阅 </span><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/conceptual/ASLR_script_objects.html#//apple_ref/doc/uid/TP40000983-CH207-SW15"><span class="md-plain">The AppleScript Inheritance Chain</span></a></span><span class="md-plain">），因此它有机会处理当前脚本或 AppleScript 未处理的命令。</span></p><p class="md-end-block md-p"><span class="md-pair-s" spellcheck="false"><code>current application</code></span><span class="md-plain"> 常量是一个对象说明符--如果向 AppleScript 询问其值，结果就是对象说明符：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false"> <span role="presentation">get current application --result: current application</span></pre><p class="md-end-block md-p"><span class="md-plain">但是，如果要求 </span><span class="md-pair-s" spellcheck="false"><code>name of current application</code></span><span class="md-plain"> ，AppleScript 会解析对象指定符，并返回当前应用程序的名称：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false"> <span role="presentation">name of current application --result: "Script Editor"</span></pre><p class="md-end-block md-p"> </p><h4 class="md-end-block md-heading"><span class="md-plain">2.9.3 missing value Constant</span></h4><p class="md-end-block md-p"><span class="md-pair-s" spellcheck="false"><code>missing value</code></span><span class="md-plain"> 常量是缺失或未初始化信息的占位符。</span> <span class="md-plain">例如，以下语句使用 </span><span class="md-pair-s" spellcheck="false"><code>missing value</code></span><span class="md-plain"> 常量来判断变量是否发生了变化：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="javascript" spellcheck="false"> <span role="presentation"><span class="cm-variable">set</span> <span class="cm-variable">myVariable</span> <span class="cm-variable">to</span> <span class="cm-variable">missing</span> <span class="cm-variable">value</span></span><br> <span role="presentation">    <span class="cm-operator">--</span> <span class="cm-variable">perform</span> <span class="cm-variable">operations</span> <span class="cm-variable">that</span> <span class="cm-variable">might</span> <span class="cm-variable">change</span> <span class="cm-variable">the</span> <span class="cm-variable">value</span> <span class="cm-variable">of</span> <span class="cm-variable">myVariable</span></span><br> <span role="presentation"><span class="cm-keyword">if</span> <span class="cm-variable">myVariable</span> <span class="cm-variable">is</span> <span class="cm-variable">equal</span> <span class="cm-variable">to</span> <span class="cm-variable">missing</span> <span class="cm-variable">value</span> <span class="cm-variable">then</span></span><br> <span role="presentation">    <span class="cm-operator">--</span> <span class="cm-variable">the</span> <span class="cm-variable">value</span> <span class="cm-variable">of</span> <span class="cm-variable">the</span> <span class="cm-variable">variable</span> <span class="cm-variable">never</span> <span class="cm-variable">changed</span></span><br> <span role="presentation"><span class="cm-keyword">else</span></span><br> <span role="presentation">    <span class="cm-operator">--</span> <span class="cm-variable">the</span> <span class="cm-variable">value</span> <span class="cm-variable">of</span> <span class="cm-variable">the</span> <span class="cm-variable">variable</span> <span class="cm-variable">did</span> <span class="cm-variable">change</span></span><br> <span role="presentation"><span class="cm-variable">end</span> <span class="cm-keyword">if</span></span><br> <span role="presentation">​</span></pre><p class="md-end-block md-p"> </p><h4 class="md-end-block md-heading"><span class="md-plain">2.9.4 true, false Constants</span></h4><p class="md-end-block md-p"><span class="md-plain">AppleScript 定义了布尔常数 </span><span class="md-pair-s" spellcheck="false"><code>true</code></span><span class="md-plain"> 和 </span><span class="md-pair-s" spellcheck="false"><code>false</code></span><span class="md-plain"> 。这些常量由 </span><span class="md-pair-s" spellcheck="false"><code>boolean</code></span><span class="md-plain"> 类描述。</span></p><p class="md-end-block md-p"> </p><h3 class="md-end-block md-heading"><span class="md-plain">2.10 The it and me Keywords</span></h3><p class="md-end-block md-p"><span class="md-plain">AppleScript定义关键字</span><span class="md-pair-s" spellcheck="false"><code>me</code></span><span class="md-plain">指向当前脚本，关键字</span><span class="md-pair-s" spellcheck="false"><code>it</code></span><span class="md-plain">指向当前目标。(* </span><span class="md-pair-s"><em><span class="md-plain">当前脚本</span></em></span> <span class="md-pair-s"><em><span class="md-plain">是当前正在执行的脚本;</span></em></span> <span class="md-pair-s"><em><span class="md-plain">当前目标</span></em></span><span class="md-plain"> *是命令的当前默认目标。)它还将“my”定义为“of me”的同义词，将“its”定义为“of It”的同义词</span></p><p class="md-end-block md-p"><span class="md-plain">如果一个脚本没有指向任何东西，</span><span class="md-pair-s" spellcheck="false"><code>it</code></span><span class="md-plain">和</span><span class="md-pair-s" spellcheck="false"><code>me</code></span><span class="md-plain">指向相同的东西——脚本，如下面的例子所示:</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="js" spellcheck="false"> <span role="presentation"><span class="cm-operator">--</span> <span class="cm-variable">At</span> <span class="cm-variable">the</span> <span class="cm-variable">top</span><span class="cm-operator">-</span><span class="cm-variable">level</span> <span class="cm-variable">of</span> <span class="cm-variable">the</span> <span class="cm-variable">script</span>:</span><br> <span role="presentation"><span class="cm-variable">me</span> <span class="cm-operator">--</span><span class="cm-variable">result</span>: <span class="cm-variable">«script»</span> (<span class="cm-variable">顶级脚本对象</span>)</span><br> <span role="presentation"><span class="cm-variable">it</span> <span class="cm-operator">--</span><span class="cm-variable">result</span>: <span class="cm-variable">«script»</span> (<span class="cm-variable">和</span><span class="cm-string-2">`it`</span><span class="cm-variable">一样，因为还没有设定目标</span>)</span></pre><p class="md-end-block md-p"> </p><p class="md-end-block md-p"><span class="md-pair-s" spellcheck="false"><code>tell</code></span><span class="md-plain"> 语句指定了默认目标。在下面的示例中，默认目标是 Finder 应用程序：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="js" spellcheck="false"> <span role="presentation"><span class="cm-operator">--</span> <span class="cm-variable">Within</span> <span class="cm-variable">a</span> <span class="cm-variable">tell</span> <span class="cm-variable">block</span>:</span><br> <span role="presentation"><span class="cm-variable">tell</span> <span class="cm-variable">application</span> <span class="cm-string">"Finder"</span> <span class="cm-operator">--</span> <span class="cm-variable">sets</span> <span class="cm-variable">target</span></span><br> <span role="presentation">    <span class="cm-variable">me</span> <span class="cm-operator">--</span><span class="cm-variable">result</span>: <span class="cm-variable">«script»</span> (<span class="cm-variable">still</span> <span class="cm-variable">the</span> <span class="cm-variable">top</span><span class="cm-operator">-</span><span class="cm-variable">level</span> <span class="cm-variable">script</span> <span class="cm-variable">object</span>)</span><br> <span role="presentation">    <span class="cm-variable">it</span> <span class="cm-operator">--</span><span class="cm-variable">result</span>: <span class="cm-variable">application</span> <span class="cm-string">"Finder"</span> (<span class="cm-variable">target</span> <span class="cm-variable">of</span> <span class="cm-variable">the</span> <span class="cm-variable">tell</span> <span class="cm-variable">statement</span>)</span><br> <span role="presentation"><span class="cm-variable">end</span> <span class="cm-variable">tell</span></span></pre><p class="md-end-block md-p"> </p><p class="md-end-block md-p"><span class="md-plain">你可以使用单词' of me '或' my '来表示命令的目标是当前脚本，而不是</span><span class="md-pair-s" spellcheck="false"><code>tell</code></span><span class="md-plain">语句的目标。在下面的例子中，单词</span><span class="md-pair-s" spellcheck="false"><code>my</code></span><span class="md-plain">表明</span><span class="md-pair-s" spellcheck="false"><code>minimumValue()</code></span><span class="md-plain">处理程序是由脚本定义的，而不是由Finder定义的:</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="js" spellcheck="false"> <span role="presentation"><span class="cm-variable">tell</span> <span class="cm-variable">application</span> <span class="cm-string">"Finder"</span></span><br> <span role="presentation">    <span class="cm-variable">set</span> <span class="cm-variable">fileCount</span> <span class="cm-variable">to</span> <span class="cm-variable">count</span> <span class="cm-variable">files</span> <span class="cm-keyword">in</span> <span class="cm-variable">front</span> <span class="cm-variable">window</span></span><br> <span role="presentation">    <span class="cm-variable">set</span> <span class="cm-variable">myCount</span> <span class="cm-variable">to</span> <span class="cm-variable">my</span> <span class="cm-variable">minimumValue</span>(<span class="cm-variable">fileCount</span>, <span class="cm-number">100</span>)</span><br> <span role="presentation">    <span class="cm-operator">--</span><span class="cm-keyword">do</span> <span class="cm-variable">something</span> <span class="cm-keyword">with</span> <span class="cm-variable">up</span> <span class="cm-variable">to</span> <span class="cm-variable">the</span> <span class="cm-variable">first</span> <span class="cm-number">100</span> <span class="cm-variable">files…</span></span><br> <span role="presentation"><span class="cm-variable">end</span> <span class="cm-variable">tell</span></span></pre><p class="md-end-block md-p"> </p><p class="md-end-block md-p"><span class="md-plain">你也可以使用</span><span class="md-pair-s" spellcheck="false"><code>of me</code></span><span class="md-plain">或</span><span class="md-pair-s" spellcheck="false"><code>my</code></span><span class="md-plain">来区分脚本属性和对象属性。假设打开了一个名为Simple.rtf的TextEdit文档:</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="js" spellcheck="false"> <span role="presentation"><span class="cm-variable">tell</span> <span class="cm-variable">document</span> <span class="cm-number">1</span> <span class="cm-variable">of</span> <span class="cm-variable">application</span> <span class="cm-string">"TextEdit"</span></span><br> <span role="presentation">    <span class="cm-variable">name</span> <span class="cm-operator">--</span><span class="cm-variable">result</span>: <span class="cm-string">"Simple.rtf"</span> (<span class="cm-variable">implicitly</span> <span class="cm-variable">uses</span> <span class="cm-variable">target</span> <span class="cm-variable">of</span> <span class="cm-variable">tell</span>)</span><br> <span role="presentation">    <span class="cm-variable">name</span> <span class="cm-variable">of</span> <span class="cm-variable">it</span> <span class="cm-operator">--</span><span class="cm-variable">result</span>: <span class="cm-string">"Simple.rtf"</span> (<span class="cm-variable">specifies</span> <span class="cm-variable">target</span> <span class="cm-variable">of</span> <span class="cm-variable">tell</span>)</span><br> <span role="presentation">    <span class="cm-variable">me</span> <span class="cm-operator">--</span><span class="cm-variable">result</span>: <span class="cm-variable">«script»</span> (<span class="cm-variable">top</span><span class="cm-operator">-</span><span class="cm-variable">level</span> <span class="cm-variable">script</span> <span class="cm-variable">object</span>, <span class="cm-variable">not</span> <span class="cm-variable">target</span> <span class="cm-variable">of</span> <span class="cm-variable">tell</span>)</span><br> <span role="presentation"><span class="cm-variable">end</span> <span class="cm-variable">tell</span></span></pre><p class="md-end-block md-p"> </p><p class="md-end-block md-p"><span class="md-plain">下面的例子展示了如何在Finder的</span><span class="md-pair-s" spellcheck="false"><code>tell</code></span><span class="md-plain">语句中指定不同的</span><span class="md-pair-s" spellcheck="false"><code>version</code></span><span class="md-plain">属性。Finder是默认目标，但使用</span><span class="md-pair-s" spellcheck="false"><code>version of me</code></span><span class="md-plain">、</span><span class="md-pair-s" spellcheck="false"><code>my version</code></span><span class="md-plain">或</span><span class="md-pair-s" spellcheck="false"><code>AppleScript</code></span><span class="md-plain">可以指定顶层</span><span class="md-pair-s" spellcheck="false"><code>script</code></span><span class="md-plain">对象的版本。(顶层的</span><span class="md-pair-s" spellcheck="false"><code>script</code></span><span class="md-plain">对象返回AppleScript版本，因为它继承自AppleScript,详见 </span><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/conceptual/ASLR_script_objects.html#//apple_ref/doc/uid/TP40000983-CH207-SW15"><span class="md-plain">The AppleScript Inheritance Chain</span></a></span><span class="md-plain">）。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="js" spellcheck="false"> <span role="presentation"><span class="cm-variable">tell</span> <span class="cm-variable">application</span> <span class="cm-string">"Finder"</span></span><br> <span role="presentation">    <span class="cm-variable">version</span> <span class="cm-operator">--</span><span class="cm-variable">result</span>: <span class="cm-string">"10.5.1"</span> (<span class="cm-variable">Finder</span> <span class="cm-variable">version</span> <span class="cm-variable">is</span> <span class="cm-variable">the</span> <span class="cm-keyword">default</span> <span class="cm-keyword">in</span> <span class="cm-variable">tell</span> <span class="cm-variable">block</span>)</span><br> <span role="presentation">    <span class="cm-variable">its</span> <span class="cm-variable">version</span> <span class="cm-operator">--</span><span class="cm-variable">result</span>: <span class="cm-string">"10.5.1"</span> (<span class="cm-variable">specifically</span> <span class="cm-variable">asks</span> <span class="cm-keyword">for</span> <span class="cm-variable">Finder</span> <span class="cm-variable">version</span>)</span><br> <span role="presentation">    <span class="cm-variable">version</span> <span class="cm-variable">of</span> <span class="cm-variable">me</span> <span class="cm-operator">--</span><span class="cm-variable">result</span>: <span class="cm-string">"2.0"</span> (<span class="cm-variable">AppleScript</span> <span class="cm-variable">version</span>)</span><br> <span role="presentation">    <span class="cm-variable">my</span> <span class="cm-variable">version</span> <span class="cm-operator">--</span><span class="cm-variable">result</span>: <span class="cm-string">"2.0"</span> (<span class="cm-variable">AppleScript</span> <span class="cm-variable">version</span>)</span><br> <span role="presentation">    <span class="cm-variable">version</span> <span class="cm-variable">of</span> <span class="cm-variable">AppleScript</span> <span class="cm-operator">--</span><span class="cm-variable">result</span>: <span class="cm-string">"2.0"</span> (<span class="cm-variable">AppleScript</span> <span class="cm-variable">version</span>)</span><br> <span role="presentation"><span class="cm-variable">end</span> <span class="cm-variable">tell</span></span></pre><p class="md-end-block md-p"><span class="md-plain">有关在筛选器引用中使用 </span><span class="md-pair-s" spellcheck="false"><code>it</code></span><span class="md-plain"> 的信息，请参阅 </span><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/reference/ASLR_reference_forms.html#//apple_ref/doc/uid/TP40000983-CH4g-BAJJHEFE"><span class="md-plain">Filter</span></a></span><span class="md-plain">引用表格的讨论部分。</span></p><p class="md-end-block md-p"> </p><h3 class="md-end-block md-heading"><span class="md-plain">2.11 Aliases and Files 别名和文件</span></h3><p class="md-end-block md-p"><span class="md-plain">要引用 macOS 文件系统中的项目和位置，可以使用 </span><span class="md-pair-s" spellcheck="false"><code>alias</code></span><span class="md-plain"> 对象和 </span><span class="md-pair-s" spellcheck="false"><code>file</code></span><span class="md-plain"> 对象。</span> <span class="md-pair-s" spellcheck="false"><code>alias</code></span><span class="md-plain"> 对象是对现有文件系统对象的动态引用。由于它是动态的，因此即使指定的文件系统对象被移动或重命名，它也能保持与该对象的链接。</span></p><p class="md-end-block md-p"><span class="md-pair-s" spellcheck="false"><code>file</code></span><span class="md-plain"> 对象代表文件系统中特定位置的特定文件。它可以指当前不存在的项目，如将要创建的文件的名称和位置。 </span><span class="md-pair-s" spellcheck="false"><code>file</code></span><span class="md-plain"> 对象不是动态的，它总是指向同一个位置，即使有不同的项目被移动到该位置。 </span><span class="md-pair-s" spellcheck="false"><code>POSIX file</code></span><span class="md-plain"> 伪类与 file 大致同义： </span><span class="md-pair-s" spellcheck="false"><code>POSIX file</code></span><span class="md-plain"> 指定符评估 </span><span class="md-pair-s" spellcheck="false"><code>file</code></span><span class="md-plain"> 对象，但它们对名称使用不同的语义，详见</span><span class="md-meta-i-c md-link"><a href="applewebdata://BE961DC6-7ABA-4896-9287-4947EA567604#//apple_ref/doc/uid/TP40000983-CH218-SW11"><span class="md-plain">Specifying Paths</span></a></span><span class="md-plain">。</span></p><p class="md-end-block md-p"><span class="md-plain">The following is the recommended usage for these types:</span> <span class="md-plain">以下是这些类型的推荐用法：</span></p><ul class="ul-list" data-mark="-"><li class="md-list-item"><p class="md-end-block md-p"><span class="md-plain">使用 </span><span class="md-pair-s" spellcheck="false"><code>alias</code></span><span class="md-plain"> 对象引用现有文件系统对象。</span></p></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-plain">使用 </span><span class="md-pair-s" spellcheck="false"><code>file</code></span><span class="md-plain"> 对象引用尚不存在的文件。</span></p></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-plain">如果要使用 POSIX 路径指定文件，请使用 </span><span class="md-pair-s" spellcheck="false"><code>POSIX file</code></span><span class="md-plain"> 指定符。</span></p></li></ul><p class="md-end-block md-p"><span class="md-plain">下文将介绍如何按路径指定文件系统对象，以及如何在脚本中使用它们。</span></p><p class="md-end-block md-p"> </p><h4 class="md-end-block md-heading"><span class="md-plain">2.11.1 Specifying Paths - 指定路径</span></h4><p class="md-end-block md-p"><span class="md-plain">您可以通过提供名称指定符来创建 </span><span class="md-pair-s" spellcheck="false"><code>alias</code></span><span class="md-plain"> 对象和 </span><span class="md-pair-s" spellcheck="false"><code>file</code></span><span class="md-plain"> 对象，其中名称是文件系统中项目的路径。</span></p><p class="md-end-block md-p"><span class="md-plain">对于别名和文件说明符，路径是一个HFS路径，格式为</span><span class="md-pair-s" spellcheck="false"><code>"disk:item:subitem:subsubitem:…:item"</code></span><span class="md-plain">。例如，</span><span class="md-pair-s" spellcheck="false"><code>"Hard_Disk:Applications:Mail. "</code></span><span class="md-plain"> app"</span><span class="md-pair-s" spellcheck="false"><code>是邮件应用程序的HFS路径，假设你的启动驱动器名为</code></span><span class="md-plain">"Hard_Disk"`。</span></p><p class="md-end-block md-p"><span class="md-plain">以冒号开头的HFS路径，如</span><span class="md-pair-s" spellcheck="false"><code>:folder:file</code></span><span class="md-plain">，相对于HFS工作目录进行解析。但是，不鼓励使用它们，因为HFS工作目录的位置是未指定的，并且没有办法从AppleScript控制它。</span></p><p class="md-end-block md-p"><span class="md-plain">对于POSIX文件说明符，路径是POSIX路径，形式为</span><span class="md-pair-s" spellcheck="false"><code>/item/subitem/subsubitem/…/item</code></span><span class="md-plain">。启动盘不需要指定磁盘名称。例如，“/Applications/Mail.”是邮件应用程序的POSIX路径。你可以在Finder的Get信息窗口的“Where”字段中看到项目的POSIX路径。尽管名称是POSIX，但POSIX文件标识符可以指向文件夹或磁盘。不支持使用“~”来指定主目录。</span></p><p class="md-end-block md-p"><span class="md-plain">不带斜线的 POSIX 路径，如 </span><span class="md-pair-s" spellcheck="false"><code>"folder/file"</code></span><span class="md-plain"> ，是相对于 POSIX 工作目录解析的。支持这种方法，但只对从 shell 运行的脚本有用--工作目录就是 shell 中的当前目录。应用程序的 POSIX 工作目录位置未指定。</span></p><p class="md-end-block md-p"> </p><h4 class="md-end-block md-heading"><span class="md-plain">2.11.2 Working With Aliases - 使用别名</span></h4><p class="md-end-block md-p"><span class="md-plain">AppleScript 定义了 </span><span class="md-pair-s" spellcheck="false"><code>alias</code></span><span class="md-plain"> 类来表示别名。别名可以存储在变量中，并在整个脚本中使用。</span></p><p class="md-end-block md-p"><span class="md-plain">下面的脚本首先在变量</span><span class="md-pair-s" spellcheck="false"><code>notesAlias</code></span><span class="md-plain">中为一个已存在的文件创建别名，然后在</span><span class="md-pair-s" spellcheck="false"><code>tell</code></span><span class="md-plain">语句中使用该变量打开文件。在创建别名之前，它使用</span><span class="md-pair-s" spellcheck="false"><code>try</code></span><span class="md-plain">语句检查别名是否存在，这样即使脚本重复运行，也只创建一次别名。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="js" spellcheck="false"> <span role="presentation"><span class="cm-keyword">try</span></span><br> <span role="presentation">    <span class="cm-variable">notesAlias</span> <span class="cm-operator">--</span> <span class="cm-variable">see</span> <span class="cm-keyword">if</span> <span class="cm-variable">we</span><span class="cm-string">'ve created the alias yet</span></span><br> <span role="presentation"><span class="cm-variable">on</span> <span class="cm-variable">error</span></span><br> <span role="presentation">    <span class="cm-operator">--</span> <span class="cm-keyword">if</span> <span class="cm-variable">not</span>, <span class="cm-variable">create</span> <span class="cm-variable">it</span> <span class="cm-keyword">in</span> <span class="cm-variable">the</span> <span class="cm-variable">error</span> <span class="cm-variable">branch</span></span><br> <span role="presentation">    <span class="cm-variable">set</span> <span class="cm-variable">notesAlias</span> <span class="cm-variable">to</span> <span class="cm-variable">alias</span> <span class="cm-string">"Hard_Disk:Users:myUser:Feb_Notes.rtf"</span></span><br> <span role="presentation"><span class="cm-variable">end</span> <span class="cm-keyword">try</span></span><br> <span role="presentation"><span class="cm-operator">--</span> <span class="cm-variable">now</span> <span class="cm-variable">open</span> <span class="cm-variable">the</span> <span class="cm-variable">file</span> <span class="cm-variable">from</span> <span class="cm-variable">the</span> <span class="cm-variable">alias</span>:</span><br> <span role="presentation"><span class="cm-variable">tell</span> <span class="cm-variable">application</span> <span class="cm-string">"TextEdit"</span> <span class="cm-variable">to</span> <span class="cm-variable">open</span> <span class="cm-variable">notesAlias</span></span></pre><p class="md-end-block md-p"> </p><p class="md-end-block md-p"><span class="md-plain">查找别名引用的对象称为* </span><span class="md-pair-s"><em><span class="md-plain">解析</span></em></span><span class="md-plain"> *别名。AppleScript 2.0仅在运行脚本时才会尝试解析别名。然而，在更早的版本中，AppleScript会尝试在编译时解析别名。</span> <span class="md-plain">运行前面的示例创建别名后，再次运行脚本时，即使文件名或位置发生变化，脚本也能找到原始文件。(不过，如果在重新编译后再次运行脚本，它将创建一个新的别名）。</span></p><p class="md-end-block md-p"><span class="md-plain">通过将别名强制转换为文本，可以从别名中获取 HFS 路径：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false"> <span role="presentation">notesAlias as text --result: "Hard_Disk:Users:myUser:Feb_Notes.rtf"</span></pre><p class="md-end-block md-p"><span class="md-plain">你可以使用</span><span class="md-pair-s" spellcheck="false"><code>POSIX path</code></span><span class="md-plain">属性来获取由别名引用的项的POSIX风格路径:</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false"> <span role="presentation">POSIX path of notesAlias --result: "/Feb_Notes.rtf"</span></pre><p class="md-end-block md-p"><span class="md-plain">如果一个别名没有引用一个现存的文件系统对象，那么它就是坏的。不能为不存在的对象创建别名，例如计划创建的文件。你可以使用一个</span><span class="md-pair-s" spellcheck="false"><code>file</code></span><span class="md-plain">对象，在下一节中描述。</span></p><p class="md-end-block md-p"><span class="md-plain">有关脚本应用程序如何处理用户将一个或多个文件图标放置在其上时收到的别名列表的示例脚本，请参阅 </span><span class="md-meta-i-c md-link"><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/conceptual/ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW16"><span class="md-plain">open Handlers</span></a></span><span class="md-plain">。</span></p><p class="md-end-block md-p"> </p><h4 class="md-end-block md-heading"><span class="md-plain">2.11.3 Working With Files - 使用文件</span></h4><p class="md-end-block md-p"><span class="md-plain">AppleScript使用</span><span class="md-pair-s" spellcheck="false"><code>file</code></span><span class="md-plain">对象在脚本中表示文件。</span><span class="md-pair-s" spellcheck="false"><code>file</code></span><span class="md-plain">对象可以存储在变量中并在整个脚本中使用。下面的脚本首先在变量</span><span class="md-pair-s" spellcheck="false"><code>notesFile</code></span><span class="md-plain">中为一个已存在的文件创建一个</span><span class="md-pair-s" spellcheck="false"><code>file</code></span><span class="md-plain">对象，然后在</span><span class="md-pair-s" spellcheck="false"><code>tell</code></span><span class="md-plain">语句中使用该变量来打开文件:</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="js" spellcheck="false"> <span role="presentation"><span class="cm-variable">set</span> <span class="cm-variable">notesFile</span> <span class="cm-variable">to</span> <span class="cm-variable">POSIX</span> <span class="cm-variable">file</span> <span class="cm-string">"/Users/myUser/Feb_Meeting_Notes.rtf"</span></span><br> <span role="presentation"><span class="cm-variable">tell</span> <span class="cm-variable">application</span> <span class="cm-string">"TextEdit"</span> <span class="cm-variable">to</span> <span class="cm-variable">open</span> <span class="cm-variable">notesFile</span></span></pre><p class="md-end-block md-p"><span class="md-plain">您可以使用 </span><span class="md-pair-s" spellcheck="false"><code>file</code></span><span class="md-plain"> 对象为可能不存在的文件指定名称和位置：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="js" spellcheck="false"> <span role="presentation"><span class="cm-variable">set</span> <span class="cm-variable">newFile</span> <span class="cm-variable">to</span> <span class="cm-variable">POSIX</span> <span class="cm-variable">file</span> <span class="cm-string">"/Users/myUser/BrandNewFile.rtf"</span></span></pre><p class="md-end-block md-p"><span class="md-plain">同样，可以让用户使用 </span><span class="md-pair-s" spellcheck="false"><code>choose file name</code></span><span class="md-plain"> 命令指定一个新文件，然后使用返回的 </span><span class="md-pair-s" spellcheck="false"><code>file</code></span><span class="md-plain"> 对象创建文件。在下面的示例中，如果用户取消 </span><span class="md-pair-s" spellcheck="false"><code>choose file name</code></span><span class="md-plain"> 对话框，脚本的其余部分将不会执行。如果用户提供了文件名，脚本就会打开文件，必要时创建文件，然后使用 </span><span class="md-pair-s" spellcheck="false"><code>try</code></span><span class="md-plain"> 语句确保在写完文件后关闭文件。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="js" spellcheck="false"> <span role="presentation"><span class="cm-variable">set</span> <span class="cm-variable">theFile</span> <span class="cm-variable">to</span> <span class="cm-variable">choose</span> <span class="cm-variable">file</span> <span class="cm-variable">name</span></span><br> <span role="presentation"><span class="cm-variable">set</span> <span class="cm-variable">referenceNumber</span> <span class="cm-variable">to</span> <span class="cm-variable">open</span> <span class="cm-keyword">for</span> <span class="cm-variable">access</span> <span class="cm-variable">theFile</span> <span class="cm-keyword">with</span> <span class="cm-variable">write</span> <span class="cm-variable">permission</span></span><br> <span role="presentation"><span class="cm-keyword">try</span></span><br> <span role="presentation">    <span class="cm-operator">--</span> <span class="cm-variable">statements</span> <span class="cm-variable">to</span> <span class="cm-variable">write</span> <span class="cm-variable">to</span> <span class="cm-variable">the</span> <span class="cm-variable">file</span></span><br> <span role="presentation"><span class="cm-variable">on</span> <span class="cm-variable">error</span></span><br> <span role="presentation">    <span class="cm-variable">close</span> <span class="cm-variable">access</span> <span class="cm-variable">referenceNumber</span></span><br> <span role="presentation"><span class="cm-variable">end</span> <span class="cm-keyword">try</span></span><br> <span role="presentation"><span class="cm-variable">close</span> <span class="cm-variable">access</span> <span class="cm-variable">referenceNumber</span></span><br> <span role="presentation">​</span></pre><p class="md-end-block md-p"><span class="md-plain">通常情况下，当你将 </span><span class="md-pair-s" spellcheck="false"><code>file</code></span><span class="md-plain"> 对象传递给一个命令，用它来对文件系统中的新项目或现有项目进行操作时，路径中的组件必须存在，命令才能成功。</span></p><p class="md-end-block md-p"> </p><h3 class="md-end-block md-heading"><span class="md-plain">2.12 Remote Applications -远程应用</span></h3><p class="md-end-block md-p"><span class="md-plain">如果远程计算机上启用了远程应用程序，并且脚本使用 eppc 样式的指定符指定了该计算机，那么脚本就可以将该计算机上的应用程序作为目标。</span></p><p class="md-end-block md-p"> </p><h4 class="md-end-block md-heading"><span class="md-plain">2.12.1 Enabling Remote Applications - 启用远程应用程序</span></h4><p class="md-end-block md-p"><span class="md-plain">脚本要向远程应用程序发送命令，必须满足以下条件：</span></p><ul class="ul-list" data-mark="-"><li class="md-list-item"><p class="md-end-block md-p"><span class="md-plain">包含应用程序的计算机和运行脚本的计算机必须通过网络相互连接。</span></p></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-plain">必须在远程计算机上启用 "远程 Apple 事件"（在 "共享 "首选项窗格中设置），并提供用户访问权限（可以允许所有用户访问，也可以只允许指定用户访问）。</span></p></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-plain">如果指定的远程应用程序没有运行，则必须运行它。</span></p></li><li class="md-list-item"><p class="md-end-block md-p"><span class="md-plain">编译或运行脚本时，必须以管理员身份进行身份验证。</span></p></li></ul><p class="md-end-block md-p"> </p><h4 class="md-end-block md-heading"><span class="md-plain">2.12.2 eppc-Style Specifiers - eppc 样式指定器</span></h4><p class="md-end-block md-p"><span class="md-plain">eppc-style 指定符的格式如下：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false"> <span role="presentation">eppc://[user[:password]@]IP_address</span></pre><ul class="ul-list" data-mark="-"><li class="md-list-item"><p class="md-end-block md-p"><span class="md-pair-s" spellcheck="false"><code>ip_address</code></span></p><p class="md-end-block md-p"><span class="md-plain">可以是十进制形式的数字 IP 地址（四个数字，从 0 到 255，用句号分隔；例如 </span><span class="md-pair-s" spellcheck="false"><code>123.23.23.123</code></span><span class="md-plain"> ），也可以是主机名。主机名可以是 Bonjour 名称。</span></p></li></ul><p class="md-end-block md-p"><span class="md-plain">以下是有效的 eppc 样式参数示例。如果提供用户名和密码，则无需验证。如果不提供，则可能需要验证。</span></p><figure class="md-table-fig table-figure"><table class="md-table"><thead><tr class="md-end-block"><th><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>"eppc://myCoolMac.local" -- hostname, no user or pwd</code></span></span></th></tr></thead><tbody><tr class="md-end-block"><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>"eppc://myUserName:pwd@myCoolMac.local" -- user, pwd, and hostname</code></span></span></td></tr><tr class="md-end-block"><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>"eppc://123.23.23.123" -- IP address, no user or pwd</code></span></span></td></tr><tr class="md-end-block"><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>"eppc://myUserName:pwd@123.23.23.123" -- user, pwd, and IP address</code></span></span></td></tr><tr class="md-end-block"><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>"eppc://myUserName@server.company.com" -- server address, user</code></span></span></td></tr></tbody></table></figure><p class="md-end-block md-p"> </p><blockquote><p class="md-end-block md-p"><span class="md-plain">重要：如果 eppc-style 指定符的某一部分包含非 UTF-8 字符或空白，则必须对其进行 URL 编码：例如，这里的用户名包含一个空格：</span></p><p class="md-end-block md-p"><span class="md-pair-s" spellcheck="false"><code>John%20Smith</code></span><span class="md-plain">.</span></p></blockquote><h4 class="md-end-block md-heading"><span class="md-plain">2.12.3 Targeting Remote Applications - 定位远程应用程序</span></h4><p class="md-end-block md-p"><span class="md-plain">您可以将远程计算机上正在运行的应用程序作为目标，也可以在远程计算机上启动当前未运行的应用程序。</span></p><p class="md-end-block md-p"><span class="md-plain">下面的示例使用 eppc 样式的指定程序，以远程计算机上的 Finder 为目标。它包含用户名和密码，因此不需要验证。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="js" spellcheck="false"> <span role="presentation"><span class="cm-variable">set</span> <span class="cm-variable">remoteMachine</span> <span class="cm-variable">to</span> <span class="cm-string">"eppc://userName:pwd@MacName.local"</span></span><br> <span role="presentation"><span class="cm-variable">tell</span> <span class="cm-variable">app</span> <span class="cm-string">"Finder"</span> <span class="cm-variable">of</span> <span class="cm-variable">machine</span> <span class="cm-variable">remoteMachine</span> <span class="cm-variable">to</span> <span class="cm-variable">close</span> <span class="cm-variable">front</span> <span class="cm-variable">window</span></span></pre><blockquote><p class="md-end-block md-p"><span class="md-plain">重要提示：如果编译了错误的 eppc 样式地址，则必须退出并重新启动脚本编辑器才能使地址更改生效。</span></p></blockquote><p class="md-end-block md-p"><span class="md-plain">在某些情况下，你需要使用 </span><span class="md-pair-s" spellcheck="false"><code>using terms from</code></span><span class="md-plain"> 语句告诉 AppleScript 针对应用程序的本地版本进行编译。下面的示例就使用了这种技术，告诉远程 Finder 应用程序打开 TextEdit 应用程序：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="js" spellcheck="false"> <span role="presentation"><span class="cm-variable">set</span> <span class="cm-variable">remoteFinder</span> <span class="cm-variable">to</span> <span class="cm-variable">application</span> <span class="cm-string">"Finder"</span> <span class="cm-variable">of</span> <span class="cm-variable">machine</span> <span class="cm-variable">¬</span></span><br> <span role="presentation">    <span class="cm-string">"eppc://myUserName:pwd@123.23.23.123"</span></span><br>  <br> <span role="presentation"><span class="cm-variable">using</span> <span class="cm-variable">terms</span> <span class="cm-variable">from</span> <span class="cm-variable">application</span> <span class="cm-string">"Finder"</span></span><br> <span role="presentation">    <span class="cm-variable">tell</span> <span class="cm-variable">remoteFinder</span></span><br> <span role="presentation">        <span class="cm-variable">open</span> <span class="cm-variable">application</span> <span class="cm-variable">file</span> <span class="cm-variable">id</span> <span class="cm-string">"com.apple.TextEdit"</span></span><br> <span role="presentation">    <span class="cm-variable">end</span> <span class="cm-variable">tell</span></span><br> <span role="presentation"><span class="cm-variable">end</span> <span class="cm-variable">using</span> <span class="cm-variable">terms</span> <span class="cm-variable">from</span></span></pre><p class="md-end-block md-p"><span class="md-plain">如果在前面的脚本中省略了密码 ( </span><span class="md-pair-s" spellcheck="false"><code>pwd</code></span><span class="md-plain"> )，运行脚本时就必须进行身份验证。</span></p><p class="md-end-block md-p"> </p><h3 class="md-end-block md-heading"><span class="md-plain">2.13 Debugging AppleScript Scripts - 调试 AppleScript 脚本</span></h3><p class="md-end-block md-p"><span class="md-plain">AppleScript 并不包含内置调试器，但它提供了几种简单的机制来帮助你调试脚本或观察脚本的运行情况。</span></p><p class="md-end-block md-p"> </p><h4 class="md-end-block md-heading"><span class="md-plain">2.13.1 Feedback From Your Script - 来自脚本的反馈</span></h4><p class="md-end-block md-p"><span class="md-plain">您可以在脚本中插入各种语句，以显示当前位置和其他信息。最简单的方法是在感兴趣的位置插入蜂鸣声命令：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false"> <span role="presentation">beep 3 -- three beeps; a very important part of the script!</span></pre><p class="md-end-block md-p"><span class="md-pair-s" spellcheck="false"><code>display dialog</code></span><span class="md-plain"> 命令可以显示脚本中正在发生的信息，与断点一样，它也会停止执行，直到您将其取消（或超时，取决于您传递的参数）。下面的示例显示了当前脚本的位置和一个变量的值：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="js" spellcheck="false"> <span role="presentation"><span class="cm-variable">display</span> <span class="cm-variable">dialog</span> <span class="cm-string">"In factorial routine; x = "</span> <span class="cm-operator">&amp;</span> (<span class="cm-variable">x</span> <span class="cm-variable">as</span> <span class="cm-variable">string</span>)</span></pre><p class="md-end-block md-p"><span class="md-pair-s" spellcheck="false"><code>say</code></span><span class="md-plain"> 命令可以通过说出指定文本来引起您的注意。在下面的示例中， </span><span class="md-pair-s" spellcheck="false"><code>currentClient</code></span><span class="md-plain"> 是一个存储客户名称的 </span><span class="md-pair-s" spellcheck="false"><code>text</code></span><span class="md-plain"> 对象：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false"> <span role="presentation">say "I'm in the clientName handler. The client is " &amp; currentClient</span></pre><p class="md-end-block md-p"> </p><h4 class="md-end-block md-heading"><span class="md-plain">2.13.2 Logging - 日志</span></h4><p class="md-end-block md-p"><span class="md-plain">脚本编辑器可以显示脚本执行过程中发送的 Apple 事件日志。在 "脚本编辑器首选项 "中，你还可以选择保留最近结果或事件日志的历史记录。</span></p><p class="md-end-block md-p"><span class="md-plain">此外，您还可以在脚本中插入 </span><span class="md-pair-s" spellcheck="false"><code>log</code></span><span class="md-plain"> 语句。日志输出会显示在脚本窗口的 "事件日志 "窗格中，如果打开了 "事件日志历史记录 "窗口，也会显示在该窗口中。</span></p><p class="md-end-block md-p"><span class="md-plain">下面的简单示例记录了 </span><span class="md-pair-s" spellcheck="false"><code>repeat with loopVariable (in list)</code></span><span class="md-plain"> 语句中的当前单词：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" lang="js" spellcheck="false"> <span role="presentation"><span class="cm-variable">set</span> <span class="cm-variable">wordList</span> <span class="cm-variable">to</span> <span class="cm-variable">words</span> <span class="cm-keyword">in</span> <span class="cm-string">"Where is the hammer?"</span></span><br> <span role="presentation"><span class="cm-variable">repeat</span> <span class="cm-keyword">with</span> <span class="cm-variable">currentWord</span> <span class="cm-keyword">in</span> <span class="cm-variable">wordList</span></span><br> <span role="presentation">    <span class="cm-variable">log</span> <span class="cm-variable">currentWord</span></span><br> <span role="presentation">    <span class="cm-keyword">if</span> <span class="cm-variable">contents</span> <span class="cm-variable">of</span> <span class="cm-variable">currentWord</span> <span class="cm-variable">is</span> <span class="cm-variable">equal</span> <span class="cm-variable">to</span> <span class="cm-string">"hammer"</span> <span class="cm-variable">then</span></span><br> <span role="presentation">        <span class="cm-variable">display</span> <span class="cm-variable">dialog</span> <span class="cm-string">"I found the hammer!"</span></span><br> <span role="presentation">    <span class="cm-variable">end</span> <span class="cm-keyword">if</span></span><br> <span role="presentation"><span class="cm-variable">end</span> <span class="cm-variable">repeat</span></span></pre><p class="md-end-block md-p"> </p><p class="md-end-block md-p"><span class="md-plain">下面显示了运行脚本时日志中出现的字词：</span></p><figure class="md-table-fig table-figure"><table class="md-table"><thead><tr class="md-end-block"><th><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>(*Where*)</code></span></span></th></tr></thead><tbody><tr class="md-end-block"><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>(*is*)</code></span></span></td></tr><tr class="md-end-block"><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>(*the*)</code></span></span></td></tr><tr class="md-end-block"><td><span class="td-span"><span class="md-pair-s" spellcheck="false"><code>(*hammer*)</code></span></span></td></tr></tbody></table></figure><p class="md-end-block md-p"> </p><h4 class="md-end-block md-heading"><span class="md-plain">2.13.3 Third Party Debuggers 第三方调试器</span></h4><p class="md-end-block md-p"><span class="md-plain md-expand">如果需要全功能调试功能，可以使用功能强大的第三方 AppleScript 调试器。</span></p></div><footer><p class="post__last-updated">This article was updated on 23/08/21</p><div class="post__tags-share"><ul class="post__tag"><li><a href="https://ct-choochoo.github.io/ch-publii-pages/tags/kai-fa/">develop</a></li></ul><aside class="post__share"><button class="post__share-button js-post__share-button" aria-label="[MISSING TRANSLATION]"><svg width="32" height="32"><use xlink:href="https://ct-choochoo.github.io/ch-publii-pages/assets/svg/svg-map.svg#share"></use></svg></button><div class="post__share-popup js-post__share-popup"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fct-choochoo.github.io%2Fch-publii-pages%2Fapplescript-ji-chu%2F" class="js-share facebook" aria-label="Share with Facebook" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://ct-choochoo.github.io/ch-publii-pages/assets/svg/svg-map.svg#facebook"/></svg> Facebook </a><a href="https://api.whatsapp.com/send?text=AppleScript%20%E5%9F%BA%E7%A1%80 https%3A%2F%2Fct-choochoo.github.io%2Fch-publii-pages%2Fapplescript-ji-chu%2F" class="js-share whatsapp" aria-label="Share with WhatsApp" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://ct-choochoo.github.io/ch-publii-pages/assets/svg/svg-map.svg#whatsapp"/></svg> WhatsApp</a></div></aside></div></footer></div></article><div class="comments-area wrapper post__inner" id="comments"><div class="评论"><div class="comments-wrapper"><h5>评论区</h5><div id="cusdis_thread" data-host="https://cusdis.com" data-app-id="a6b326ad-a95f-4d7f-9076-1b06f4819430" data-page-id="37" data-page-url="https://ct-choochoo.github.io/ch-publii-pages/applescript-ji-chu/" data-page-title="AppleScript 基础" data-theme="light"></div><noscript>Please enable JS to use the comments form.</noscript><script type="text/javascript">var cusdis_element_to_check = document.getElementById('cusdis_thread');

				if ('IntersectionObserver' in window) {
					var iObserver = new IntersectionObserver(
						(entries, observer) => {
							entries.forEach(entry => {
								if (entry.intersectionRatio >= 0.1) {
									(function () {
										var d = document, s = d.createElement('script');
										s.defer = true;
										s.src = 'https://cusdis.com/js/cusdis.es.js';									
										(d.head || d.body).appendChild(s);
									})();
									observer.unobserve(entry.target);
								}
							});
						},
						{
							threshold: [0, 0.2, 0.5, 1]
						}
					);

					iObserver.observe(cusdis_element_to_check);
				} else {
					(function () {
						var d = document, s = d.createElement('script');
						s.defer = true;
						s.src = 'https://cusdis.com/js/cusdis.es.js';
						(d.head || d.body).appendChild(s);
					})();
				}</script><script type="text/javascript"></script></div></div></div><div class="post__related"><div class="wrapper wrapper--narrow"><h3 class="h5">Related posts</h3><div class="l-grid l-grid--fixed"><article class="c-card"><div class="c-card__wrapper"><figure class="c-card__image"><img src="https://ct-choochoo.github.io/ch-publii-pages/media/posts/35/2022-02-27-08.13.15-2782507757125630619_5823209264.jpg" srcset="https://ct-choochoo.github.io/ch-publii-pages/media/posts/35/responsive/2022-02-27-08.13.15-2782507757125630619_5823209264-xs.webp 384w, https://ct-choochoo.github.io/ch-publii-pages/media/posts/35/responsive/2022-02-27-08.13.15-2782507757125630619_5823209264-sm.webp 600w" sizes="(min-width: 600px) 14.285vw, 100vw" loading="lazy" height="1440" width="1440" alt=""></figure><div class="c-card__content"><header><h2 class="c-card__title"><a href="https://ct-choochoo.github.io/ch-publii-pages/applescript-gai-shu/">AppleScript 概述</a></h2></header><footer class="c-card__meta"><a href="https://ct-choochoo.github.io/ch-publii-pages/tags/kai-fa/" class="c-card__tag">develop</a> <time datetime="2023-08-20T16:52">23/08/20 </time><a href="https://ct-choochoo.github.io/ch-publii-pages/applescript-gai-shu/#comments" aria-label="Comments" rel="nofollow" class="c-card__comments"><svg><use xlink:href="https://ct-choochoo.github.io/ch-publii-pages/assets/svg/svg-map.svg#comments"/></svg></a></footer></div></div></article></div></div></div><div class="banner banner--after-post"><script async defer="defer" src="https://cusdis.com/js/widget/lang/zh-cn.js"></script><script defer="defer" data-host="https://cusdis.com" data-app-id="{{id}}" src="https://cusdis.com/js/cusdis-count.umd.js"></script><div id="cusdis_thread" data-host="https://cusdis.com" data-app-id="a6b326ad-a95f-4d7f-9076-1b06f4819430" data-page-id="{{id}}" data-page-url="{{url}} " data-page-title="{{title}}"></div></div></main><footer class="footer"><div class="wrapper"><div class="footer__top"><a class="logo footer__logo" href="https://ct-choochoo.github.io/ch-publii-pages/">As One Wants</a><div class="footer__nav-1"><h3 class="h6">TOOLS</h3><ul class="footer__nav"><li><a href="https://codegen.bqrdh.com/json/editor" target="_blank">Json格式化</a></li><li><a href="https://tool.browser.qq.com/" target="_blank">腾讯-&quot;帮小忙&quot;</a></li></ul></div><div class="footer__nav-2"><h3 class="h6">SITES</h3><ul class="footer__nav"><li><a href="https://www.v2ex.com/" target="_blank">v2ex</a></li><li><a href="https://www.cloudflare.com/" target="_blank">cloudflare</a></li><li><a href="http://jandan.net/" target="_self">jandan</a></li><li><a href="https://cusdis.com/" target="_blank">cusdis</a></li><li><a href="https://cloud.umami.is/" target="_blank">umami</a></li></ul></div></div><div class="footer__bottom"><div class="footer__copyright"><div style="text-align: left;"><a href="https://beian.miit.gov.cn/">陕ICP备2022014196号-1</a></div></div></div></div><button onclick="backToTopFunction()" id="backToTop" class="footer__bttop" aria-label="Back to top" title="Back to top"><svg><use xlink:href="https://ct-choochoo.github.io/ch-publii-pages/assets/svg/svg-map.svg#toparrow"/></svg></button></footer><script>window.publiiThemeMenuConfig = { mobileMenuMode: 'sidebar', animationSpeed: 300, submenuWidth: 'auto', doubleClickTime: 500, mobileMenuExpandableSubmenus: true, relatedContainerForOverlayMenuSelector: '.navbar', };</script><script defer="defer" src="https://ct-choochoo.github.io/ch-publii-pages/assets/js/scripts.min.js?v=f38d0d176b831ac1c3053faa12bb916d"></script><script>function publiiDetectLoadedImages () {
         var images = document.querySelectorAll('img[loading]:not(.is-loaded)');
         for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                  images[i].classList.add('is-loaded');
                  images[i].parentNode.classList.add('is-loaded');
            } else {
                  images[i].addEventListener('load', function () {
                     this.classList.add('is-loaded');
                     this.parentNode.classList.add('is-loaded');
                  }, false);
            }
         }
      }
      publiiDetectLoadedImages();</script><script defer="defer" src="https://ct-choochoo.github.io/ch-publii-pages/assets/js/quicklink.umd.js?v=a52ee49fe4afff274f8c30fe880ddc13"></script><script>window.addEventListener('load', () =>{
      quicklink.listen();
      });</script><script defer="defer" data-host="https://cusdis.com" data-app-id="a6b326ad-a95f-4d7f-9076-1b06f4819430" src="https://cusdis.com/js/cusdis-count.umd.js"></script><script src="https://ct-choochoo.github.io/ch-publii-pages/media/plugins/docSearch/docsearch.min.js"></script><script type="text/javascript">docsearch({
				container: '#docsearch',
				appId: '1940K55EKT',
				indexName: 'blog_aow',
				apiKey: '965ece45fd8bcfe08b8ce02572e77ea7',
				debug: false
			});</script></body></html>